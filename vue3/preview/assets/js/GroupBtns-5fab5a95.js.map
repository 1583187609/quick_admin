{"version":3,"file":"GroupBtns-5fab5a95.js","sources":["../../../src/components/BaseCrud/_components/GroupBtns.vue"],"sourcesContent":["<template>\r\n  <div class=\"group-btns\" :class=\"[vertical ? 'f-c-c-c' : 'f-c-c']\">\r\n    <BaseBtn\r\n      :class=\"{ 'ml-0-i': vertical }\"\r\n      :name=\"btn\"\r\n      :data=\"row\"\r\n      @click=\"handleClick(btn)\"\r\n      v-bind=\"defaultBtnAttrs\"\r\n      v-for=\"(btn, ind) in newBtns.slice(0, isOver ? maxNum - 1 : maxNum)\"\r\n      :key=\"ind\"\r\n    />\r\n    <el-dropdown :trigger=\"dropPopconfirm ? 'hover' : 'click'\" :hide-on-click=\"dropPopconfirm\" v-if=\"isOver\">\r\n      <el-button class=\"ml-12\" :class=\"[vertical ? 'ml-0-i' : '']\" :icon=\"ArrowDown\" type=\"primary\" v-bind=\"defaultBtnAttrs\">\r\n        更多\r\n      </el-button>\r\n      <template #dropdown>\r\n        <el-dropdown-menu>\r\n          <el-dropdown-item v-for=\"(btn, ind) in newBtns.slice(maxNum - 1)\" :key=\"ind\">\r\n            <BaseBtn :name=\"btn\" :data=\"row\" @click=\"handleClick(btn)\" v-bind=\"defaultBtnAttrs\" />\r\n          </el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </template>\r\n    </el-dropdown>\r\n    <template v-if=\"!newBtns.length\">{{ emptyStr }}</template>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { computed, inject } from \"vue\";\r\nimport { ArrowDown } from \"@element-plus/icons-vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { sortObjArrByKey, showMessage, defaultGroupBtnsMaxNum } from \"@/components/_utils\";\r\nimport { BaseBtnType, BtnItem, getBtnObj } from \"@/components/BaseBtn\";\r\nimport { ClosePopupType } from \"@/App.vue\";\r\nimport config from \"@/config\";\r\nimport { CommonObj, FinallyNext } from \"@/vite-env\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"GroupBtns\" }); \n\r\nexport type GroupBtnsType = BaseBtnType[] | ((row: CommonObj) => BaseBtnType[]);\r\nexport interface GroupBtnsAttrs {\r\n  vertical?: boolean;\r\n  maxNum?: number;\r\n  compact?: boolean; //是否紧凑型\r\n  small?: boolean; //是否小型\r\n}\r\nconst defaultBtnAttrs = {\r\n  size: \"small\",\r\n  plain: true,\r\n  text: true,\r\n  style: \"padding: 0\",\r\n};\r\nconst router = useRouter();\r\nconst closePopup: any = inject(\"closePopup\");\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    btns?: BaseBtnType[];\r\n    row?: CommonObj;\r\n    maxNum?: number;\r\n    vertical?: boolean;\r\n    emptyStr?: any;\r\n    compact?: boolean;\r\n    small?: boolean;\r\n  }>(),\r\n  Object.assign(\r\n    {\r\n      btns: () => [],\r\n      maxNum: defaultGroupBtnsMaxNum,\r\n      emptyStr: \"-\",\r\n    },\r\n    config?.BaseCrud?._components?.GroupBtns\r\n  )\r\n);\r\nconst emits = defineEmits([\"click\"]);\r\nlet dropPopconfirm = false; //更多按钮的下拉菜单中是否存在 popconfirm\r\nconst isOver = computed(() => props.btns?.length > props.maxNum); //必须使用computed，不然会导致更多下拉项不能变为普通按钮显示状态\r\nconst newBtns = computed(() => {\r\n  const { maxNum } = props;\r\n  //将按钮名字，转换成完整对象形式的按钮信息\r\n  const tempBtns = props.btns?.map((item: any) => getBtnObj(item)) || [];\r\n  sortObjArrByKey(tempBtns);\r\n  dropPopconfirm = !tempBtns.slice(maxNum - 1).some(it => it.popconfirm);\r\n  return tempBtns;\r\n});\r\nfunction handleClick(btnObj: BtnItem) {\r\n  const { name, text, to } = btnObj;\r\n  if (to) {\r\n    router.push(to as any);\r\n  } else {\r\n    emits(\"click\", btnObj, (hint = `${text || \"操作\"}成功！`, closeType?: ClosePopupType, cb?: () => void) => {\r\n      showMessage(hint);\r\n      closePopup(closeType);\r\n      cb?.();\r\n    });\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.group-btns {\r\n}\r\n.ml-0-i {\r\n  margin-left: 0 !important;\r\n}\r\n</style>\r\n"],"names":["defaultBtnAttrs","size","plain","text","style","router","useRouter","closePopup","inject","props","__props","emits","__emit","dropPopconfirm","isOver","computed","_a","btns","length","maxNum","newBtns","tempBtns","map","item","getBtnObj","sortObjArrByKey","slice","some","it","popconfirm","handleClick","btnObj","name","to","push","hint","closeType","cb","showMessage"],"mappings":"u3DA6CA,MAAMA,EAAkB,CACtBC,KAAM,QACNC,OAAO,EACPC,MAAM,EACNC,MAAO,cAEHC,EAASC,IACTC,EAAkBC,EAAO,cACzBC,EAAQC,EAmBRC,EAAQC,EACd,IAAIC,GAAiB,EACf,MAAAC,EAASC,GAAS,WAAM,OAAA,OAAAC,EAAAP,EAAMQ,WAAND,EAAAA,EAAYE,QAAST,EAAMU,MAAA,IACnDC,EAAUL,GAAS,WACjB,MAAAI,OAAEA,GAAWV,EAEbY,GAAW,OAAAL,EAAAP,EAAMQ,WAAND,EAAAA,EAAYM,KAAKC,GAAcC,EAAUD,OAAU,GAG7D,OAFPE,EAAgBJ,GACCR,GAACQ,EAASK,MAAMP,EAAS,GAAGQ,MAAWC,GAAAA,EAAGC,aACpDR,CAAA,IAET,SAASS,EAAYC,GACnB,MAAMC,KAAEA,EAAA7B,KAAMA,EAAM8B,GAAAA,GAAOF,EACvBE,EACF5B,EAAO6B,KAAKD,GAENtB,EAAA,QAASoB,GAAQ,CAACI,EAAO,GAAGhC,GAAQ,UAAWiC,EAA4BC,KAC/EC,EAAYH,GACZ5B,EAAW6B,GACN,MAAAC,GAAAA,GAAA,GAGX"}