{"version":3,"file":"BaseNumberRange-958bbd4d.js","sources":["../../../src/components/BaseNumberRange.vue"],"sourcesContent":["<template>\r\n  <div class=\"f-fs-fs base-number-range\">\r\n    <el-form-item class=\"f-1 hide-err-text\" :prop=\"minProp\" :rules=\"[{ validator: validate, trigger: 'blur' }]\">\r\n      <el-input\r\n        v-model.number=\"minVal\"\r\n        @change=\"handleChange('min')\"\r\n        @clear=\"handleClear('min')\"\r\n        placeholder=\"最小值\"\r\n        clearable\r\n      />\r\n    </el-form-item>\r\n    <div class=\"f-c-c f-0 separator\" :class=\"size\">\r\n      {{ rangeSeparator }}\r\n    </div>\r\n    <el-form-item class=\"f-1 hide-err-text\" :prop=\"maxProp\" :rules=\"[{ validator: validate, trigger: 'blur' }]\">\r\n      <el-input\r\n        v-model.number=\"maxVal\"\r\n        @change=\"handleChange('max')\"\r\n        @clear=\"handleClear('max')\"\r\n        placeholder=\"最大值\"\r\n        clearable\r\n      />\r\n    </el-form-item>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { ref, reactive, watch, computed, useAttrs } from \"vue\";\r\nimport { useFormItem } from \"element-plus\";\r\nimport { CommonObj, StrNum, CommonSize } from \"@/vite-env\";\r\nimport { emptyVals, propsJoinChar, rangeJoinChar, showMessage } from \"@/components/_utils\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"BaseNumberRange\" }); \n\r\ntype InputType = \"min\" | \"max\";\r\ntype StrNumUnd = StrNum | undefined;\r\nconst { formItem } = useFormItem();\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    modelValue?: [StrNumUnd, StrNumUnd];\r\n    prop?: string | [string, string];\r\n    label?: string;\r\n    rules?: any[];\r\n    attrs?: CommonObj;\r\n    rangeSeparator?: string;\r\n    size?: CommonSize;\r\n  }>(),\r\n  {\r\n    rangeSeparator: rangeJoinChar,\r\n  }\r\n);\r\nconst emits = defineEmits([\"update:modelValue\", \"change\", \"clear\"]);\r\nconst [minProp, maxProp] = [`${props.prop}[0]`, `${props.prop}[1]`];\r\nconst minVal = computed<StrNumUnd>({\r\n  get() {\r\n    return props.modelValue?.[0];\r\n  },\r\n  set(val: StrNumUnd) {\r\n    emits(\"update:modelValue\", [val, maxVal.value]);\r\n  },\r\n});\r\nconst maxVal = computed<StrNumUnd>({\r\n  get() {\r\n    return props.modelValue?.[1];\r\n  },\r\n  set(val: StrNumUnd) {\r\n    emits(\"update:modelValue\", [minVal.value, val]);\r\n  },\r\n});\r\n\r\nfunction validate(rule: any, value: any, callback: any) {\r\n  if (minVal.value === undefined || minVal.value === \"\" || maxVal.value === undefined || maxVal.value === \"\") {\r\n    callback();\r\n  } else {\r\n    if (minVal.value > maxVal.value) {\r\n      showMessage(props.label + \"最小值不能超过最大值\", \"error\");\r\n      callback(\"最小值不能超过最大值\");\r\n    } else {\r\n      callback();\r\n    }\r\n  }\r\n}\r\nfunction handleChange(type: InputType) {\r\n  const { prop } = props;\r\n  const arrVals = [minVal.value, maxVal.value];\r\n  emits(\"change\", prop?.join?.(propsJoinChar) ?? prop, arrVals);\r\n}\r\nfunction handleClear(type: InputType) {\r\n  const { prop } = props;\r\n  const arrVals = type === \"min\" ? [undefined, maxVal.value] : [minVal.value, undefined];\r\n  const _prop = prop?.join?.(propsJoinChar) ?? prop;\r\n  emits(\"change\", _prop, arrVals);\r\n  emits(\"clear\", _prop, arrVals);\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.base-number-range {\r\n  width: 200px;\r\n  .separator {\r\n    line-height: 32px;\r\n    margin: 0 $gap-half;\r\n    &.small {\r\n      line-height: 24px;\r\n      margin: 0 $gap-qtr;\r\n    }\r\n  }\r\n}\r\n:deep(.hide-err-text) {\r\n  .el-form-item__error {\r\n    display: none;\r\n  }\r\n}\r\n</style>\r\n"],"names":["useFormItem","props","__props","emits","__emit","minProp","maxProp","prop","minVal","computed","get","_a","modelValue","set","val","maxVal","value","validate","rule","callback","showMessage","label","handleChange","type","arrVals","join","call","propsJoinChar","handleClear","_prop"],"mappings":"yqDAmCiCA,IACjC,MAAMC,EAAQC,EAcRC,EAAQC,GACPC,EAASC,GAAW,CAAC,GAAGL,EAAMM,UAAW,GAAGN,EAAMM,WACnDC,EAASC,EAAoB,CACjC,GAAAC,SACS,OAAA,OAAAC,EAAAV,EAAMW,iBAAa,EAAAD,EAAA,EAC5B,EACA,GAAAE,CAAIC,GACFX,EAAM,oBAAqB,CAACW,EAAKC,EAAOC,OAC1C,IAEID,EAASN,EAAoB,CACjC,GAAAC,SACS,OAAA,OAAAC,EAAAV,EAAMW,iBAAa,EAAAD,EAAA,EAC5B,EACA,GAAAE,CAAIC,GACFX,EAAM,oBAAqB,CAACK,EAAOQ,MAAOF,GAC5C,IAGO,SAAAG,EAASC,EAAWF,EAAYG,QAClB,IAAjBX,EAAOQ,OAAwC,KAAjBR,EAAOQ,YAAiC,IAAjBD,EAAOC,OAAwC,KAAjBD,EAAOC,UAGxFR,EAAOQ,MAAQD,EAAOC,OACZI,EAAAnB,EAAMoB,MAAQ,aAAc,SACxCF,EAAS,kBAKf,CACA,SAASG,EAAaC,SACd,MAAAhB,KAAEA,GAASN,EACXuB,EAAU,CAAChB,EAAOQ,MAAOD,EAAOC,OACtCb,EAAM,UAAU,OAAAQ,EAAM,MAAAJ,OAAA,EAAAA,EAAAkB,WAAO,EAAAd,EAAAe,KAAAnB,EAAAoB,KAAkBpB,EAAMiB,EACvD,CACA,SAASI,EAAYL,SACb,MAAAhB,KAAEA,GAASN,EACXuB,EAAmB,QAATD,EAAiB,MAAC,EAAWR,EAAOC,OAAS,CAACR,EAAOQ,WAAO,GACtEa,GAAQ,OAAAlB,EAAA,MAAAJ,OAAA,EAAAA,EAAMkB,WAAN,EAAAd,EAAAe,KAAAnB,EAAaoB,KAAkBpB,EACvCJ,EAAA,SAAU0B,EAAOL,GACjBrB,EAAA,QAAS0B,EAAOL,EACxB"}