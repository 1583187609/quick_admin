{"version":3,"file":"index-3bb514f4.js","sources":["../../../src/views/system/menu/index.vue"],"sourcesContent":["<template>\r\n  <BaseCrud\r\n    :cols=\"cols\"\r\n    :fields=\"fields\"\r\n    :fetch=\"handleFetch\"\r\n    :extraBtns=\"['add', 'delete']\"\r\n    :groupBtns=\"['edit', 'delete', (row:CommonObj)=>row.status===1 ? 'forbid' : 'enable']\"\r\n    :pagination=\"false\"\r\n    @extraBtn=\"onExtraBtn\"\r\n    @groupBtn=\"onGroupBtn\"\r\n    selection\r\n  >\r\n    <template #icon=\"{ row }\">\r\n      <BaseIcon :name=\"row.icon\" size=\"22\" v-if=\"row.icon\"></BaseIcon>\r\n      <template v-else>-</template>\r\n    </template>\r\n  </BaseCrud>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { ref, reactive, inject } from \"vue\";\r\nimport { GetAuthMenuList, DeleteAuthMenuList } from \"@/api-mock\";\r\nimport { BtnName } from \"@/components/BaseBtn\";\r\nimport { FormField } from \"@/components/BaseFormItem\";\r\nimport { TableField } from \"@/components/table\";\r\nimport AddEdit from \"./AddEdit/Index.vue\";\r\nimport { CommonObj, FinallyNext } from \"@/vite-env\";\r\nimport { MenuTreeNode } from \"./_components/MenuTree.vue\";\r\nimport { handleBtnNext } from \"@/utils\";\r\nimport { ExtraBtnRestArgs } from \"@/components/BaseCrud\";\r\nimport { h } from \"vue\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"SystemMenu\" }); \n\r\n\r\nconst openPopup: any = inject(\"openPopup\");\r\nconst menuTree = ref<MenuTreeNode[]>([]);\r\nconst fields = ref<FormField[]>([\r\n  { prop: \"name\", label: \"菜单名称\" },\r\n  {\r\n    prop: \"is_link\",\r\n    label: \"是否外链\",\r\n    type: \"select\",\r\n    options: \"YesNoStatus\",\r\n  },\r\n  {\r\n    prop: \"status\",\r\n    label: \"状态\",\r\n    type: \"select\",\r\n    options: \"EnableStatus\",\r\n  },\r\n  {\r\n    prop: \"is_cache\",\r\n    label: \"是否缓存\",\r\n    type: \"select\",\r\n    options: \"YesNoStatus\",\r\n  },\r\n  {\r\n    prop: \"create_time_range\",\r\n    label: \"创建时间\",\r\n    type: \"date-picker\",\r\n  },\r\n]);\r\nconst cols = ref<TableField[]>([\r\n  {\r\n    prop: \"name\",\r\n    label: \"名称\",\r\n    minWidth: 220,\r\n    align: \"left\",\r\n  },\r\n  {\r\n    prop: \"type_text\",\r\n    label: \"类型\",\r\n    minWidth: 60,\r\n  },\r\n  { prop: \"icon\", label: \"图标\", width: 60, type: \"custom\" },\r\n  { prop: \"order\", label: \"排序\", width: 60 },\r\n  {\r\n    prop: \"perms\",\r\n    label: \"权限标识\",\r\n    width: 180,\r\n  },\r\n  { prop: \"menu_path\", label: \"菜单路径\", minWidth: 300 },\r\n  { prop: \"component_path\", label: \"组件路径\", minWidth: 300 },\r\n  {\r\n    prop: \"status\",\r\n    label: \"状态\",\r\n    type: \"BaseTag\",\r\n  },\r\n  { prop: \"remark\", label: \"备注\" },\r\n  { prop: \"create_time\", label: \"创建时间\" },\r\n  { prop: \"update_time\", label: \"创建时间\" },\r\n]);\r\nfunction onExtraBtn(name: BtnName, next: FinallyNext, restArgs: ExtraBtnRestArgs) {\r\n  const { selectedKeys } = restArgs;\r\n  handleBtnNext(\r\n    {\r\n      add: () => handleAddEdit(null, next),\r\n      delete: () => handleDelete(selectedKeys, next),\r\n    },\r\n    name\r\n  );\r\n}\r\nfunction onGroupBtn(name: any, row: CommonObj, next: FinallyNext) {\r\n  handleBtnNext(\r\n    {\r\n      edit: () => handleAddEdit(row, next),\r\n      delete: () => handleDelete([row.id], next),\r\n      forbid: () => handleToggleStatus(row, next),\r\n      enable: () => handleToggleStatus(row, next),\r\n    },\r\n    name\r\n  );\r\n}\r\n//新增/删除\r\nfunction handleAddEdit(row: CommonObj | undefined, next: FinallyNext) {\r\n  openPopup(`${row ? \"编辑\" : \"新增\"}菜单`, h(AddEdit, { data: row, menuTree: menuTree.value, refreshList: next }));\r\n}\r\n//删除\r\nfunction handleDelete(ids: string[], next: FinallyNext) {\r\n  DeleteAuthMenuList({ ids }).then((res: CommonObj) => {\r\n    next();\r\n  });\r\n}\r\n//切换状态\r\nfunction handleToggleStatus(row: CommonObj, next: FinallyNext) {}\r\n\r\n//处理请求\r\nfunction handleFetch(data: CommonObj) {\r\n  return GetAuthMenuList(data).then((res: CommonObj) => {\r\n    menuTree.value = res.records;\r\n    return res;\r\n  });\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"],"names":["openPopup","inject","menuTree","ref","fields","prop","label","type","options","cols","minWidth","align","width","onExtraBtn","name","next","restArgs","selectedKeys","handleBtnNext","add","handleAddEdit","delete","handleDelete","onGroupBtn","row","edit","id","forbid","enable","h","AddEdit","data","value","refreshList","ids","DeleteAuthMenuList","then","res","handleFetch","GetAuthMenuList","records"],"mappings":"ypDAkCM,MAAAA,EAAiBC,EAAO,aACxBC,EAAWC,EAAoB,IAC/BC,EAASD,EAAiB,CAC9B,CAAEE,KAAM,OAAQC,MAAO,QACvB,CACED,KAAM,UACNC,MAAO,OACPC,KAAM,SACNC,QAAS,eAEX,CACEH,KAAM,SACNC,MAAO,KACPC,KAAM,SACNC,QAAS,gBAEX,CACEH,KAAM,WACNC,MAAO,OACPC,KAAM,SACNC,QAAS,eAEX,CACEH,KAAM,oBACNC,MAAO,OACPC,KAAM,iBAGJE,EAAON,EAAkB,CAC7B,CACEE,KAAM,OACNC,MAAO,KACPI,SAAU,IACVC,MAAO,QAET,CACEN,KAAM,YACNC,MAAO,KACPI,SAAU,IAEZ,CAAEL,KAAM,OAAQC,MAAO,KAAMM,MAAO,GAAIL,KAAM,UAC9C,CAAEF,KAAM,QAASC,MAAO,KAAMM,MAAO,IACrC,CACEP,KAAM,QACNC,MAAO,OACPM,MAAO,KAET,CAAEP,KAAM,YAAaC,MAAO,OAAQI,SAAU,KAC9C,CAAEL,KAAM,iBAAkBC,MAAO,OAAQI,SAAU,KACnD,CACEL,KAAM,SACNC,MAAO,KACPC,KAAM,WAER,CAAEF,KAAM,SAAUC,MAAO,MACzB,CAAED,KAAM,cAAeC,MAAO,QAC9B,CAAED,KAAM,cAAeC,MAAO,UAEvB,SAAAO,EAAWC,EAAeC,EAAmBC,GAC9C,MAAAC,aAAEA,GAAiBD,EACzBE,EACE,CACEC,IAAK,IAAMC,EAAc,KAAML,GAC/BM,OAAQ,IAAMC,EAAaL,EAAcF,IAE3CD,EAEJ,CACS,SAAAS,EAAWT,EAAWU,EAAgBT,GAC7CG,EACE,CACEO,KAAM,IAAML,EAAcI,EAAKT,GAC/BM,OAAQ,IAAMC,EAAa,CAACE,EAAIE,IAAKX,GACrCY,OAAQ,KAAkC,EAC1CC,OAAQ,KACV,GACAd,EAEJ,CAES,SAAAM,EAAcI,EAA4BT,GACjDf,GAAawB,EAAM,KAAO,MAAhB,KAA0BK,EAAEC,EAAS,CAAEC,KAAMP,EAAKtB,SAAUA,EAAS8B,MAAOC,YAAalB,IACrG,CAES,SAAAO,EAAaY,EAAenB,GACnCoB,EAAmB,CAAED,QAAOE,MAAMC,UAGpC,CAKA,SAASC,EAAYP,GACnB,OAAOQ,EAAgBR,GAAMK,MAAMC,IACjCnC,EAAS8B,MAAQK,EAAIG,QACdH,IAEX"}