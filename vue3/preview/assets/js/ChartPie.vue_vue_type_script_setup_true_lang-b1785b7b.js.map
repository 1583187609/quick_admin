{"version":3,"file":"ChartPie.vue_vue_type_script_setup_true_lang-b1785b7b.js","sources":["../../../src/components/chart/ChartPie.vue"],"sourcesContent":["<template>\r\n  <Chart class=\"chart-pie\" :option=\"newOpt\" :height=\"height\" :width=\"width\" :theme=\"theme\"></Chart>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport * as echarts from \"echarts\";\r\nimport { reactive, computed } from \"vue\";\r\nimport Chart from \"@/components/chart/Chart.vue\";\r\nimport { axisCfg, gradColors, titleCfg } from \"./_config\";\r\nimport { typeOf } from \"@/components/_utils\";\r\nimport type { EchartTheme, ChartData } from \"./_config/types\";\r\nimport { CommonObj } from \"@/vite-env\";\r\nimport { merge } from \"lodash\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"ChartPie\" }); \n\r\nconst defaultOption = {\r\n  // title: {},\r\n  tooltip: {},\r\n  legend: {\r\n    // x: \"5%\",\r\n    // y: \"center\",\r\n    itemGap: 20,\r\n    itemHeight: 12,\r\n    itemWidth: 12,\r\n    // orient: \"vertical\",\r\n    // formatter(name) {\r\n    //     let val = dataset.source.find(item => {\r\n    //         return item[0] === name;\r\n    //     })[1];\r\n    //     return `{label|${name}}{value|${val}${unit}}`;\r\n    // },\r\n    color: \"#999\",\r\n    fontSize: 14,\r\n    rich: {\r\n      label: {\r\n        width: 150,\r\n      },\r\n      value: {\r\n        color: \"#333\",\r\n        fontWeight: \"bold\",\r\n        width: 100,\r\n      },\r\n    },\r\n  },\r\n  // dataset: {\r\n  //   source: [\r\n  //     [\"主要负责人用车\", 150],\r\n  //   ],\r\n  // },\r\n  // series: [{type: \"pie\"}],\r\n};\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    theme?: EchartTheme;\r\n    height?: string | number;\r\n    width?: string | number;\r\n    title?: string;\r\n    unit?: string;\r\n    data?: ChartData;\r\n    hollow?: boolean;\r\n    radius?: [number, number];\r\n    center?: [string, string];\r\n    option?: CommonObj;\r\n  }>(),\r\n  {\r\n    hollow: true,\r\n    radius: () => [72, 93],\r\n    center: () => [\"75%\", \"50%\"],\r\n    data: () => [\r\n      [\"主要负责人用车\", 150],\r\n      [\"其他公务用车\", 149],\r\n      [\"经营和业务保险专用车\", 150],\r\n    ],\r\n    option: () => ({}),\r\n  }\r\n);\r\nconst newOpt = computed<CommonObj>(() => {\r\n  const { title, hollow, unit, data, option } = props;\r\n  return merge(\r\n    {},\r\n    defaultOption,\r\n    {\r\n      ...(title && { title: { text: title, ...titleCfg } }),\r\n      ...(hollow ? getHollowLegendCfg() : {}),\r\n      // legend: {\r\n      //   formatter(name: string) {\r\n      //     let val = data?.find((item: any) => {\r\n      //       return item[0] === name;\r\n      //     })[1];\r\n      //     return `{label|${name}}{value|${val}${unit}}`;\r\n      //   },\r\n      // },\r\n      dataset: {\r\n        source: data,\r\n      },\r\n      series: [\r\n        {\r\n          type: \"pie\",\r\n          ...(hollow ? getHollowSeriesCfg() : {}),\r\n          itemStyle: {\r\n            borderColor: \"#fff\",\r\n            borderWidth: 2,\r\n            color: (params: CommonObj) => {\r\n              const ind = params.dataIndex;\r\n              //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上\r\n              return new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n                {\r\n                  offset: 0,\r\n                  color: gradColors[ind][0],\r\n                },\r\n                {\r\n                  offset: 1,\r\n                  color: gradColors[ind][1],\r\n                },\r\n              ]);\r\n            },\r\n          },\r\n        },\r\n      ],\r\n    },\r\n    option\r\n  );\r\n});\r\n//获取空心饼图的legend配置\r\nfunction getHollowLegendCfg() {\r\n  return {\r\n    legend: {\r\n      x: \"5%\",\r\n      y: \"center\",\r\n      orient: \"vertical\",\r\n    },\r\n  };\r\n}\r\n//获取空心饼图的series配置\r\nfunction getHollowSeriesCfg() {\r\n  let total = 0;\r\n  const { radius, center, data, unit } = props;\r\n  data.forEach(item => {\r\n    total += Number(item[1]);\r\n  });\r\n  return {\r\n    radius,\r\n    center,\r\n    label: {\r\n      show: true,\r\n      position: \"center\",\r\n      color: \"#4c4a4a\",\r\n      formatter: `{value|${total}}\\n\\r{label|车辆总数${unit ? `(${unit})` : \"\"}}`,\r\n      rich: {\r\n        value: {\r\n          color: \"#333\",\r\n          fontSize: 24,\r\n          lineHeight: 24,\r\n          fontWeight: \"bold\",\r\n        },\r\n        label: {\r\n          color: \"#999\",\r\n          fontSize: 14,\r\n          lineHeight: 24,\r\n          fontWeight: \"bold\",\r\n        },\r\n      },\r\n      //下面这样写会触发警告\r\n      // emphasis: {\r\n      //   show: true,\r\n      // },\r\n    },\r\n  };\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"],"names":["defaultOption","tooltip","legend","itemGap","itemHeight","itemWidth","color","fontSize","rich","label","width","value","fontWeight","props","__props","newOpt","computed","title","hollow","unit","data","option","merge","text","titleCfg","x","y","orient","dataset","source","series","type","getHollowSeriesCfg","itemStyle","borderColor","borderWidth","params","ind","dataIndex","echarts.graphic.LinearGradient","offset","gradColors","total","radius","center","forEach","item","Number","show","position","formatter","lineHeight"],"mappings":"ghBAgBA,MAAMA,EAAgB,CAEpBC,QAAS,CAAC,EACVC,OAAQ,CAGNC,QAAS,GACTC,WAAY,GACZC,UAAW,GAQXC,MAAO,OACPC,SAAU,GACVC,KAAM,CACJC,MAAO,CACLC,MAAO,KAETC,MAAO,CACLL,MAAO,OACPM,WAAY,OACZF,MAAO,QAWTG,EAAQC,EAyBRC,EAASC,GAAoB,KACjC,MAAMC,MAAEA,EAAOC,OAAAA,EAAAC,KAAQA,EAAMC,KAAAA,EAAAC,OAAMA,GAAWR,EACvC,OAAAS,EAAAA,MACL,CAAC,EACDtB,EACA,IACMiB,GAAS,CAAEA,MAAO,CAAEM,KAAMN,KAAUO,OACpCN,EA0CD,CACLhB,OAAQ,CACNuB,EAAG,KACHC,EAAG,SACHC,OAAQ,aA9C4B,CAAC,EASrCC,QAAS,CACPC,OAAQT,GAEVU,OAAQ,CACN,CACEC,KAAM,SACFb,EAASc,IAAuB,CAAC,EACrCC,UAAW,CACTC,YAAa,OACbC,YAAa,EACb7B,MAAQ8B,IACN,MAAMC,EAAMD,EAAOE,UAEnB,OAAO,IAAIC,EAA+B,EAAG,EAAG,EAAG,EAAG,CACpD,CACEC,OAAQ,EACRlC,MAAOmC,EAAWJ,GAAK,IAEzB,CACEG,OAAQ,EACRlC,MAAOmC,EAAWJ,GAAK,KAE1B,MAMXhB,EAAA,IAcJ,SAASW,IACP,IAAIU,EAAQ,EACZ,MAAMC,OAAEA,EAAAC,OAAQA,EAAQxB,KAAAA,EAAAD,KAAMA,GAASN,EAIhC,OAHFO,EAAAyB,SAAgBC,IACVJ,GAAAK,OAAOD,EAAK,GAAE,IAElB,CACLH,SACAC,SACAnC,MAAO,CACLuC,MAAM,EACNC,SAAU,SACV3C,MAAO,UACP4C,UAAW,UAAUR,oBAAwBvB,EAAO,IAAIA,KAAU,MAClEX,KAAM,CACJG,MAAO,CACLL,MAAO,OACPC,SAAU,GACV4C,WAAY,GACZvC,WAAY,QAEdH,MAAO,CACLH,MAAO,OACPC,SAAU,GACV4C,WAAY,GACZvC,WAAY,UAStB"}