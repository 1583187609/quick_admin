{"version":3,"file":"ChartBars.vue_vue_type_script_setup_true_lang-7215e9e3.js","sources":["../../../src/components/chart/ChartBars.vue"],"sourcesContent":["<template>\r\n  <Chart class=\"chart-bars\" :option=\"newOpt\" :height=\"height\" :width=\"width\" :theme=\"theme\"></Chart>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport * as echarts from \"echarts\";\r\nimport { reactive, computed } from \"vue\";\r\nimport Chart from \"@/components/chart/Chart.vue\";\r\nimport { axisCfg, gradColors, titleCfg } from \"./_config\";\r\nimport type { EchartTheme, ChartData } from \"./_config/types\";\r\nimport { merge } from \"lodash\";\r\nimport { CommonObj } from \"@/vite-env\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"ChartBars\" }); \n\r\nconst defaultOption = {\r\n  // title: titles,\r\n  tooltip: {\r\n    trigger: \"item\",\r\n  },\r\n  barWidth: 12,\r\n  barGap: \"50%\",\r\n  grid: [\r\n    { left: 0, width: \"47%\", bottom: 30, top: 40, containLabel: true },\r\n    { right: 0, width: \"47%\", bottom: 30, top: 40, containLabel: true },\r\n  ],\r\n  // xAxis,\r\n  // yAxis,\r\n  // dataset: datasets,\r\n  // series,\r\n};\r\n\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    theme?: EchartTheme;\r\n    height?: string | number;\r\n    width?: string | number;\r\n    titles?: string[];\r\n    units?: string[];\r\n    datas?: ChartData[];\r\n    option?: CommonObj;\r\n  }>(),\r\n  {\r\n    titles: () => [],\r\n    units: () => [],\r\n    datas: () => [\r\n      [\r\n        [\"name\", \"国内\", \"国外\"],\r\n        [\"示例1\", 30, 22],\r\n        [\"示例2\", 14, 42],\r\n        [\"示例3\", 18, 23],\r\n        // [\"name\", \"国内\"],\r\n        // [\"建筑工程\", 30],\r\n        // [\"能源化工\", 14],\r\n        // [\"交通运输\", 18],\r\n      ],\r\n      [\r\n        [\"name\", \"国内\", \"国外\"],\r\n        [\"示例1\", 23, 62],\r\n        [\"示例2\", 65, 88],\r\n        [\"示例3\", 66, 48],\r\n        // [\"name\", \"国内\"],\r\n        // [\"建筑工程\", 23],\r\n        // [\"能源化工\", 65],\r\n        // [\"交通运输\", 66],\r\n      ],\r\n    ],\r\n    option: () => ({}),\r\n  }\r\n);\r\nconst newOpt = computed(() => {\r\n  const { datasets, newTitles, series, xAxis, yAxis } = getCfgArgs();\r\n  const { option } = props;\r\n  return merge(\r\n    {},\r\n    defaultOption,\r\n    {\r\n      title: newTitles,\r\n      // tooltip: {\r\n      //   trigger: \"item\",\r\n      // },\r\n      // barWidth: 12,\r\n      // barGap: \"50%\",\r\n      grid: [\r\n        { left: 0, width: \"47%\", bottom: 30, top: 40, containLabel: true },\r\n        { right: 0, width: \"47%\", bottom: 30, top: 40, containLabel: true },\r\n      ],\r\n      xAxis,\r\n      yAxis,\r\n      dataset: datasets,\r\n      series,\r\n    },\r\n    option\r\n  );\r\n});\r\nfunction getTotal(arr: any[]) {\r\n  let total = 0;\r\n  arr.forEach(itemArr => {\r\n    for (let i = 1; i < itemArr.length; i++) {\r\n      total += Number(itemArr[i]);\r\n    }\r\n  });\r\n  return total;\r\n}\r\n/**\r\n * 获取配置参数\r\n */\r\nfunction getCfgArgs() {\r\n  const [datasets, newTitles, series, xAxis, yAxis]: any = [[], [], [], [], []];\r\n  const { option, titles, units, datas } = props;\r\n  datas.forEach((data, index) => {\r\n    const title = titles[index] || \"XXX标题\";\r\n    const unit = units[index] || \"元\";\r\n    newTitles.push({\r\n      gridIndex: index,\r\n      left: index == 0 ? \"25%\" : \"75%\",\r\n      bottom: 0,\r\n      textAlign: \"center\",\r\n      text: `{label|${title}}  {amount|${getTotal(data.slice(1))}${unit}}`,\r\n      textStyle: {\r\n        rich: {\r\n          label: {\r\n            fontSize: 14,\r\n            fontWeight: \"bold\",\r\n            color: \"#666\",\r\n          },\r\n          amount: {\r\n            color: \"#333\",\r\n            fontSize: 15,\r\n            fontWeight: \"bold\",\r\n          },\r\n        },\r\n      },\r\n    });\r\n    xAxis.push({\r\n      type: \"category\",\r\n      gridIndex: index,\r\n      ...axisCfg,\r\n    });\r\n    yAxis.push({\r\n      type: \"value\",\r\n      gridIndex: index,\r\n      name: unit,\r\n      ...axisCfg,\r\n    });\r\n    datasets.push({ source: data });\r\n    const dimensions = data[0];\r\n    for (let i = 0; i < dimensions.length - 1; i++) {\r\n      series.push({\r\n        type: \"bar\",\r\n        xAxisIndex: index,\r\n        yAxisIndex: index,\r\n        datasetIndex: index,\r\n        itemStyle: {\r\n          color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n            {\r\n              //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上\r\n              offset: 0,\r\n              color: gradColors[i][0],\r\n            },\r\n            {\r\n              offset: 1,\r\n              color: gradColors[i][1],\r\n            },\r\n          ]),\r\n          borderRadius: [6, 6, 0, 0],\r\n        },\r\n        label: {\r\n          show: true,\r\n          position: \"top\",\r\n          color: \"#666\",\r\n          fontSize: 14,\r\n        },\r\n      });\r\n    }\r\n  });\r\n  return {\r\n    datasets,\r\n    newTitles,\r\n    series,\r\n    xAxis,\r\n    yAxis,\r\n  };\r\n}\r\n/**\r\n * 获取series 的itemStyle的color值\r\n * @param ind {number} 数组下标值\r\n * @param isMulti {boolean} 是否是多维度\r\n */\r\n// function getItemColor(ind: number, isMulti?: boolean) {\r\n//   isMulti = typeOf(isMulti) === \"Undefined\" ? dimensions.length > 2 : isMulti;\r\n//   /** 多维度多色，同一维度同一种颜色 */\r\n//   if (isMulti) {\r\n//     //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上\r\n//     return new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n//       {\r\n//         offset: 0,\r\n//         color: gradColors[ind][0],\r\n//       },\r\n//       {\r\n//         offset: 1,\r\n//         color: gradColors[ind][1],\r\n//       },\r\n//     ]);\r\n//   } else {\r\n//     /** 单维度多色可用，同一维度不同颜色 */\r\n//     return (params: CommonObj) => {\r\n//       const i = params.dataIndex;\r\n//       //颜色渐变函数 前四个参数分别表示四个位置依次为左、下、右、上\r\n//       return new echarts.graphic.LinearGradient(0, 0, 0, 1, [\r\n//         {\r\n//           offset: 0,\r\n//           color: gradColors[i][0],\r\n//         },\r\n//         {\r\n//           offset: 1,\r\n//           color: gradColors[i][1],\r\n//         },\r\n//       ]);\r\n//     };\r\n//   }\r\n// }\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"],"names":["defaultOption","tooltip","trigger","barWidth","barGap","grid","left","width","bottom","top","containLabel","right","props","__props","newOpt","computed","datasets","newTitles","series","xAxis","yAxis","option","titles","units","datas","forEach","data","index","title","unit","push","gridIndex","textAlign","text","getTotal","slice","textStyle","rich","label","fontSize","fontWeight","color","amount","type","axisCfg","name","source","dimensions","i","length","xAxisIndex","yAxisIndex","datasetIndex","itemStyle","echarts.graphic.LinearGradient","offset","gradColors","borderRadius","show","position","getCfgArgs","merge","dataset","arr","total","itemArr","Number"],"mappings":"4hBAeA,MAAMA,EAAgB,CAEpBC,QAAS,CACPC,QAAS,QAEXC,SAAU,GACVC,OAAQ,MACRC,KAAM,CACJ,CAAEC,KAAM,EAAGC,MAAO,MAAOC,OAAQ,GAAIC,IAAK,GAAIC,cAAc,GAC5D,CAAEC,MAAO,EAAGJ,MAAO,MAAOC,OAAQ,GAAIC,IAAK,GAAIC,cAAc,KAQ3DE,EAAQC,EAsCRC,EAASC,GAAS,KACtB,MAAMC,SAAEA,EAAUC,UAAAA,EAAAC,OAAWA,QAAQC,EAAOC,MAAAA,GAoC9C,WACE,MAAOJ,EAAUC,EAAWC,EAAQC,EAAOC,GAAc,CAAC,GAAI,GAAI,GAAI,GAAI,KACpEC,OAAEA,EAAAC,OAAQA,EAAQC,MAAAA,EAAAC,MAAOA,GAAUZ,EAmElC,OAlEDY,EAAAC,SAAQ,CAACC,EAAMC,KACb,MAAAC,EAAQN,EAAOK,IAAU,QACzBE,EAAON,EAAMI,IAAU,IAC7BV,EAAUa,KAAK,CACbC,UAAWJ,EACXrB,KAAe,GAATqB,EAAa,MAAQ,MAC3BnB,OAAQ,EACRwB,UAAW,SACXC,KAAM,UAAUL,eAAmBM,EAASR,EAAKS,MAAM,MAAMN,KAC7DO,UAAW,CACTC,KAAM,CACJC,MAAO,CACLC,SAAU,GACVC,WAAY,OACZC,MAAO,QAETC,OAAQ,CACND,MAAO,OACPF,SAAU,GACVC,WAAY,YAKpBrB,EAAMW,KAAK,CACTa,KAAM,WACNZ,UAAWJ,KACRiB,IAELxB,EAAMU,KAAK,CACTa,KAAM,QACNZ,UAAWJ,EACXkB,KAAMhB,KACHe,IAEL5B,EAASc,KAAK,CAAEgB,OAAQpB,IAClB,MAAAqB,EAAarB,EAAK,GACxB,IAAA,IAASsB,EAAI,EAAGA,EAAID,EAAWE,OAAS,EAAGD,IACzC9B,EAAOY,KAAK,CACVa,KAAM,MACNO,WAAYvB,EACZwB,WAAYxB,EACZyB,aAAczB,EACd0B,UAAW,CACTZ,MAAO,IAAIa,EAA+B,EAAG,EAAG,EAAG,EAAG,CACpD,CAEEC,OAAQ,EACRd,MAAOe,EAAWR,GAAG,IAEvB,CACEO,OAAQ,EACRd,MAAOe,EAAWR,GAAG,MAGzBS,aAAc,CAAC,EAAG,EAAG,EAAG,IAE1BnB,MAAO,CACLoB,MAAM,EACNC,SAAU,MACVlB,MAAO,OACPF,SAAU,KAGhB,IAEK,CACLvB,WACAC,YACAC,SACAC,QACAC,QAEJ,CAhHwDwC,IAChDvC,OAAEA,GAAWT,EACZ,OAAAiD,EAAAA,MACL,CAAC,EACD7D,EACA,CACE4B,MAAOX,EAMPZ,KAAM,CACJ,CAAEC,KAAM,EAAGC,MAAO,MAAOC,OAAQ,GAAIC,IAAK,GAAIC,cAAc,GAC5D,CAAEC,MAAO,EAAGJ,MAAO,MAAOC,OAAQ,GAAIC,IAAK,GAAIC,cAAc,IAE/DS,QACAC,QACA0C,QAAS9C,EACTE,UAEFG,EAAA,IAGJ,SAASa,EAAS6B,GAChB,IAAIC,EAAQ,EAML,OALHD,EAAAtC,SAAmBwC,IACrB,IAAA,IAASjB,EAAI,EAAGA,EAAIiB,EAAQhB,OAAQD,IACzBgB,GAAAE,OAAOD,EAAQjB,GAC1B,IAEKgB,CACT"}