{"version":3,"file":"AddDelTag-e23065e8.js","sources":["../../../src/components/AddDelTag.vue"],"sourcesContent":["<!-- 组件-可编辑的标签 -->\r\n<template>\r\n  <div class=\"add-del-tag f-fs-fs-w\">\r\n    <el-tag class=\"m-2\" @close=\"handleDel(item, ind)\" v-for=\"(item, ind) in tags\" :key=\"item\" closable>{{ item }} </el-tag>\r\n    <template v-if=\"tags.length < maxNum\">\r\n      <el-input\r\n        class=\"inp m-2\"\r\n        size=\"small\"\r\n        closable\r\n        placeholder=\"请输入\"\r\n        autofocus\r\n        clearable\r\n        v-model=\"inpVal\"\r\n        @blur=\"handleAdd\"\r\n        v-focus\r\n        ref=\"inpRef\"\r\n        v-if=\"showInp\"\r\n      />\r\n      <el-button class=\"m-2\" :icon=\"Plus\" size=\"small\" type=\"primary\" plain @click=\"showInp = true\" v-else> </el-button>\r\n    </template>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { ref, reactive, watch, computed, useAttrs, nextTick } from \"vue\";\r\nimport { Plus } from \"@element-plus/icons-vue\";\r\nimport { OptionItem, StrNum, CommonObj } from \"@/vite-env\";\r\nimport { useFormItem } from \"element-plus\";\r\nimport { showMessage } from \"./_utils\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"AddDelTag\" }); \n\r\n\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    modelValue?: string[];\r\n    maxNum?: number; //最大个数\r\n  }>(),\r\n  {\r\n    maxNum: 10,\r\n    modelValue: () => [],\r\n  }\r\n);\r\nconst emits = defineEmits([\"update:modelValue\"]);\r\nconst { formItem } = useFormItem();\r\nconst inpRef = ref();\r\nconst inpVal = ref(\"\");\r\nconst tags = ref<string[]>(props.modelValue);\r\nconst showInp = ref(false);\r\nwatch(\r\n  tags,\r\n  newVal => {\r\n    emits(\"update:modelValue\", JSON.parse(JSON.stringify(newVal)));\r\n    formItem?.validate(\"change\");\r\n  },\r\n  { deep: true }\r\n);\r\n//处理删除逻辑\r\nfunction handleDel(item: string, ind: number) {\r\n  tags.value.splice(ind, 1);\r\n}\r\n//处理新增逻辑\r\nfunction handleAdd() {\r\n  if (inpVal.value === \"\") {\r\n    showInp.value = false;\r\n    return;\r\n  }\r\n  if (tags.value.find(it => it === inpVal.value)) {\r\n    showMessage(inpVal.value + \"已添加\");\r\n    nextTick(() => {\r\n      inpRef.value.focus();\r\n    });\r\n    return;\r\n  }\r\n  tags.value.push(inpVal.value);\r\n  showInp.value = false;\r\n  inpVal.value = \"\";\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.inp {\r\n  width: 6em;\r\n}\r\n</style>\r\n"],"names":["props","__props","emits","__emit","formItem","useFormItem","inpRef","ref","inpVal","tags","modelValue","showInp","handleAdd","value","find","it","showMessage","nextTick","focus","push","watch","newVal","JSON","parse","stringify","validate","deep","item","ind","splice"],"mappings":"yoDAgCA,MAAMA,EAAQC,EAURC,EAAQC,GACRC,SAAEA,GAAaC,IACfC,EAASC,IACTC,EAASD,EAAI,IACbE,EAAOF,EAAcP,EAAMU,YAC3BC,EAAUJ,GAAI,GAcpB,SAASK,IACH,GAAiB,KAAjBJ,EAAOK,MAAP,CAIA,GAAAJ,EAAKI,MAAMC,SAAWC,IAAOP,EAAOK,QAKtC,OAJYG,EAAAR,EAAOK,MAAQ,YAC3BI,GAAS,KACPX,EAAOO,MAAMK,WAIZT,EAAAI,MAAMM,KAAKX,EAAOK,OACvBF,EAAQE,OAAQ,EAChBL,EAAOK,MAAQ,EAVf,MAFEF,EAAQE,OAAQ,CAapB,QA5BAO,EACEX,GACUY,IACRnB,EAAM,oBAAqBoB,KAAKC,MAAMD,KAAKE,UAAUH,KACrD,MAAAjB,GAAAA,EAAUqB,SAAS,SAAA,GAErB,CAAEC,MAAM,uKAGD,SAAUC,EAAcC,GAC1BnB,EAAAI,MAAMgB,OAAOD,EAAK,EACzB"}