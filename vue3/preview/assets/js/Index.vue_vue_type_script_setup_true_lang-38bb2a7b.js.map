{"version":3,"file":"Index.vue_vue_type_script_setup_true_lang-38bb2a7b.js","sources":["../../../src/views/system/menu/AddEdit/Index.vue"],"sourcesContent":["<template>\r\n  <BaseForm\r\n    v-model=\"model\"\r\n    style=\"width: 600px\"\r\n    :fields=\"fields\"\r\n    :fetch=\"data ? PostAuthMenuUpdate : PostAuthMenuAdd\"\r\n    :fetchSuccess=\"refreshList\"\r\n    @change=\"handleChange\"\r\n  >\r\n    <template #parent_id>\r\n      <MenuTree :data=\"menuTree\" v-model=\"model.parent_id\" />\r\n    </template>\r\n    <template #icon=\"{}\">\r\n      <IconPicker v-model=\"model.icon\" />\r\n    </template>\r\n  </BaseForm>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { ref, reactive, watch, computed } from \"vue\";\r\nimport IconPicker from \"./_components/IconPicker.vue\";\r\nimport { GetAuthMenuInfo, PostAuthMenuAdd, PostAuthMenuUpdate } from \"@/api-mock\";\r\nimport MenuTree from \"./_components/MenuTree.vue\";\r\nimport { CommonObj, FinallyNext, StrNum } from \"@/vite-env\";\r\nimport { defaultIconName } from \"@/utils\";\r\nimport { useDictMap } from \"@/hooks\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"SystemMenuAddEditIndex\" }); \n\r\n\r\nconst { getText } = useDictMap();\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    data?: CommonObj;\r\n    menuTree?: any[];\r\n    refreshList?: FinallyNext;\r\n  }>(),\r\n  {}\r\n);\r\nconst model = reactive<CommonObj>(\r\n  Object.assign(\r\n    {\r\n      type: 1,\r\n      order: 1,\r\n      is_cache: 1,\r\n      is_link: 0,\r\n      is_blank_open: 0,\r\n      is_show: 1,\r\n      status: 1,\r\n      icon: defaultIconName,\r\n    },\r\n    props.data\r\n  )\r\n);\r\nconst fields = computed(() => {\r\n  const menuType = model.type;\r\n  return [\r\n    {\r\n      prop: \"type\",\r\n      label: \"菜单类型\",\r\n      required: true,\r\n      type: \"radio-group\",\r\n      options: \"MenuType\",\r\n      extra: {\r\n        popover: \"目录：XXXX；菜单：XXXX；按钮：XXXXX\",\r\n      },\r\n      attrs: {\r\n        type: \"button\",\r\n      },\r\n    },\r\n    menuType === 1 && {\r\n      prop: \"parent_id\",\r\n      label: \"上级菜单\",\r\n      type: \"custom\",\r\n      extra: {\r\n        popover: \"上级菜单\",\r\n      },\r\n    },\r\n    {\r\n      prop: \"name\",\r\n      label: getText(\"MenuType\", menuType) + \"名称\",\r\n      required: true,\r\n      attrs: {\r\n        maxlength: 10,\r\n      },\r\n    },\r\n    menuType !== 2 && {\r\n      prop: \"icon\",\r\n      label: \"图标\",\r\n      type: \"custom\",\r\n      required: true,\r\n    },\r\n    ...(menuType === 2\r\n      ? [\r\n          {\r\n            prop: \"perms\",\r\n            label: \"权限标识\",\r\n            attrs: {\r\n              placeholder: \"请输入权限标识，用,或，隔开（示例：0,1，2）\",\r\n            },\r\n          },\r\n        ]\r\n      : []),\r\n    {\r\n      prop: \"order\",\r\n      label: \"排序\",\r\n      required: true,\r\n      type: \"input-number\",\r\n      extra: {\r\n        popover: \"数值越大越靠后\",\r\n      },\r\n      attrs: {\r\n        style: \"width: 205px\",\r\n        placeholder: \"数值越小，越靠前\",\r\n      },\r\n    },\r\n    ...(menuType === 1\r\n      ? [\r\n          {\r\n            prop: \"component_path\",\r\n            label: \"组件路径\",\r\n            required: true,\r\n            extra: {\r\n              popover: \"仅输入src/views后面的路径即可\",\r\n            },\r\n          },\r\n          {\r\n            prop: \"menu_path\",\r\n            label: \"路由地址\",\r\n            required: true,\r\n            extra: {\r\n              example: \"/auth\",\r\n              tips: \"建议跟组件路径保持一致\",\r\n            },\r\n          },\r\n          {\r\n            prop: \"is_cache\",\r\n            label: \"是否缓存\",\r\n            type: \"radio-group\",\r\n            required: true,\r\n            options: \"YesNoStatus\",\r\n            extra: {\r\n              span: 12,\r\n              popover: \"是否缓存该页面\",\r\n            },\r\n          },\r\n          {\r\n            prop: \"is_show\",\r\n            label: \"是否显示\",\r\n            type: \"radio-group\",\r\n            required: true,\r\n            options: \"YesNoStatus\",\r\n            extra: {\r\n              span: 12,\r\n              popover: \"在菜单目录中是否可见\",\r\n            },\r\n          },\r\n          {\r\n            prop: \"is_link\",\r\n            label: \"是否外链\",\r\n            required: true,\r\n            type: \"radio-group\",\r\n            options: \"YesNoStatus\",\r\n            extra: {\r\n              span: 12,\r\n            },\r\n          },\r\n          model.is_link === 1 && {\r\n            prop: \"is_blank_open\",\r\n            label: \"新窗口打开\",\r\n            required: true,\r\n            type: \"radio-group\",\r\n            options: \"YesNoStatus\",\r\n            extra: {\r\n              span: 12,\r\n            },\r\n          },\r\n        ]\r\n      : []),\r\n    {\r\n      prop: \"status\",\r\n      label: \"状态\",\r\n      required: true,\r\n      type: \"radio-group\",\r\n      options: \"EnableStatus\",\r\n      extra: {\r\n        span: 12,\r\n        popover: \"启用后，在菜单中可见，否则不可见\",\r\n      },\r\n    },\r\n  ];\r\n});\r\ngetInfo(props.data?.id);\r\nfunction getInfo(id?: StrNum) {\r\n  if (!id) return;\r\n  GetAuthMenuInfo({ id }).then((res: CommonObj) => {\r\n    const { type } = res;\r\n    type === 2 && (res.type = 1);\r\n    type === 3 && (res.type = 2);\r\n    Object.assign(model, res);\r\n  });\r\n}\r\nfunction handleChange(prop: string, val: any) {\r\n  if (prop === \"component_path\") {\r\n    if (!model.menu_path) model.menu_path = val.replace(\".vue\", \"\");\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"],"names":["getText","useDictMap","props","__props","model","reactive","Object","assign","type","order","is_cache","is_link","is_blank_open","is_show","status","icon","defaultIconName","data","fields","computed","menuType","prop","label","required","options","extra","popover","attrs","maxlength","placeholder","style","example","tips","span","handleChange","val","menu_path","replace","id","GetAuthMenuInfo","then","res","getInfo","_a"],"mappings":"igBA6BM,MAAAA,QAAEA,GAAYC,IACdC,EAAQC,EAQRC,EAAQC,EACZC,OAAOC,OACL,CACEC,KAAM,EACNC,MAAO,EACPC,SAAU,EACVC,QAAS,EACTC,cAAe,EACfC,QAAS,EACTC,OAAQ,EACRC,KAAMC,GAERd,EAAMe,OAGJC,EAASC,GAAS,KACtB,MAAMC,EAAWhB,EAAMI,KAChB,MAAA,CACL,CACEa,KAAM,OACNC,MAAO,OACPC,UAAU,EACVf,KAAM,cACNgB,QAAS,WACTC,MAAO,CACLC,QAAS,4BAEXC,MAAO,CACLnB,KAAM,WAGG,IAAbY,GAAkB,CAChBC,KAAM,YACNC,MAAO,OACPd,KAAM,SACNiB,MAAO,CACLC,QAAS,SAGb,CACEL,KAAM,OACNC,MAAOtB,EAAQ,WAAYoB,GAAY,KACvCG,UAAU,EACVI,MAAO,CACLC,UAAW,KAGF,IAAbR,GAAkB,CAChBC,KAAM,OACNC,MAAO,KACPd,KAAM,SACNe,UAAU,MAEK,IAAbH,EACA,CACE,CACEC,KAAM,QACNC,MAAO,OACPK,MAAO,CACLE,YAAa,8BAInB,GACJ,CACER,KAAM,QACNC,MAAO,KACPC,UAAU,EACVf,KAAM,eACNiB,MAAO,CACLC,QAAS,WAEXC,MAAO,CACLG,MAAO,eACPD,YAAa,gBAGA,IAAbT,EACA,CACE,CACEC,KAAM,iBACNC,MAAO,OACPC,UAAU,EACVE,MAAO,CACLC,QAAS,wBAGb,CACEL,KAAM,YACNC,MAAO,OACPC,UAAU,EACVE,MAAO,CACLM,QAAS,QACTC,KAAM,gBAGV,CACEX,KAAM,WACNC,MAAO,OACPd,KAAM,cACNe,UAAU,EACVC,QAAS,cACTC,MAAO,CACLQ,KAAM,GACNP,QAAS,YAGb,CACEL,KAAM,UACNC,MAAO,OACPd,KAAM,cACNe,UAAU,EACVC,QAAS,cACTC,MAAO,CACLQ,KAAM,GACNP,QAAS,eAGb,CACEL,KAAM,UACNC,MAAO,OACPC,UAAU,EACVf,KAAM,cACNgB,QAAS,cACTC,MAAO,CACLQ,KAAM,KAGQ,IAAlB7B,EAAMO,SAAiB,CACrBU,KAAM,gBACNC,MAAO,QACPC,UAAU,EACVf,KAAM,cACNgB,QAAS,cACTC,MAAO,CACLQ,KAAM,MAIZ,GACJ,CACEZ,KAAM,SACNC,MAAO,KACPC,UAAU,EACVf,KAAM,cACNgB,QAAS,eACTC,MAAO,CACLQ,KAAM,GACNP,QAAS,qBAEb,IAaK,SAAAQ,EAAab,EAAcc,GACrB,mBAATd,IACGjB,EAAMgC,YAAWhC,EAAMgC,UAAYD,EAAIE,QAAQ,OAAQ,KAEhE,QAbA,SAAiBC,GACf,IAAKA,EAAI,OACTC,EAAgB,CAAED,OAAME,MAAMC,IACtB,MAAAjC,KAAEA,GAASiC,EACR,IAAAjC,IAAMiC,EAAIjC,KAAO,GACjB,IAAAA,IAAMiC,EAAIjC,KAAO,GACnBF,OAAAC,OAAOH,EAAOqC,EAAG,GAE5B,CATQC,CAAA,OAAAC,EAAAzC,EAAMe,WAAN,EAAA0B,EAAYL"}