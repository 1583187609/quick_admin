{"version":3,"file":"index-4e235bca.js","sources":["../../../src/components/BaseBtn/_utils.ts","../../../src/components/BaseBtn/index.ts"],"sourcesContent":["import * as Icons from \"@element-plus/icons-vue\";\r\nimport { CircleCloseFilled } from \"@element-plus/icons-vue\";\r\nimport { getUserInfo, typeOf } from \"@/components/_utils\";\r\nimport { merge, upperFirst } from \"lodash\";\r\n// import { useSlots } from \"vue\";\r\nimport btnsMap from \".\";\r\nimport cssVars from \"@/assets/styles/_var.module.scss\";\r\nimport { CommonObj } from \"@/vite-env\";\r\nimport { PopconfirmAttrs, BaseBtnType, BtnItem, BtnName, BtnFn } from \"./_types\";\r\nimport { FilterAuthItem } from \"@/components/BaseCrud\";\r\n\r\n/**\r\n * 获取popconfirm的属性对象\r\n * @param popconfirm string boolean object\r\n * @param text string 按钮文字\r\n */\r\nfunction getPopconfirmAttrs(popconfirm: string | boolean | CommonObj, btnObj: BtnItem): PopconfirmAttrs {\r\n  const { text, attrs = {} } = btnObj;\r\n  const title = `确认${text}？`;\r\n  const t = typeOf(popconfirm);\r\n  if (t === \"String\") {\r\n    return { title: popconfirm as string };\r\n  } else if (t === \"Object\") {\r\n    return merge({ title }, popconfirm);\r\n  } else if (popconfirm === true) {\r\n    const { type } = attrs;\r\n    return {\r\n      title,\r\n      iconColor: cssVars[\"color\" + upperFirst(type)],\r\n      confirmButtonType: type,\r\n    };\r\n  } else {\r\n    console.error(`暂未处理此种情况：${t}`, popconfirm);\r\n    return { title: \"~error~\", icon: CircleCloseFilled, iconColor: \"#f56c6c\" };\r\n  }\r\n}\r\n\r\n/**\r\n * 根据按钮名或按钮对象获取按钮对象\r\n * @param btn string | object | function 按钮名或按钮对象或方法函数\r\n */\r\nexport function getBtnObj(btn: BaseBtnType, row?: CommonObj): BtnItem {\r\n  const t = typeOf(btn);\r\n  // const $slots = useSlots();\r\n  let btnObj: BtnItem = { name: \"\" };\r\n  if (t === \"String\") {\r\n    const targetBtn = btnsMap[btn as BtnName] || Object.assign({}, btnsMap.empty, { text: btn });\r\n    //icon 经过 JSON.parse(JSON.stringify())之后，重新渲染时会报错，故做此处理\r\n    const { icon } = targetBtn.attrs || {};\r\n    btnObj = JSON.parse(JSON.stringify(targetBtn));\r\n    btnObj!.attrs!.icon = icon;\r\n  } else if (t === \"Object\") {\r\n    const { name } = btn as BtnItem;\r\n    btnObj = merge({}, btnsMap[name as string], btn);\r\n    if (btnObj.text === undefined) {\r\n      // btnObj.text = $slots.default?.()?.[0]?.children as string;\r\n      btnObj.text = \"空按钮\";\r\n    }\r\n  } else if (t === \"Function\") {\r\n    btnObj = getBtnObj((btn as BtnFn)(row as CommonObj), row);\r\n  }\r\n  const { auth, attrs, popconfirm } = btnObj;\r\n  if (auth?.length) {\r\n    btnObj.auth = auth.map((it: FilterAuthItem) => {\r\n      if (typeof it !== \"object\") return it;\r\n      const { disabled, code } = it;\r\n      //感觉没必要加上 && getUserInfo().type===code，但暂时先这么写，后面再思考\r\n      if (disabled && getUserInfo().type === code) {\r\n        attrs ? (attrs.disabled = true) : (btnObj.attrs = { disabled: true });\r\n      }\r\n      return code;\r\n    });\r\n  }\r\n  if (popconfirm) {\r\n    btnObj.popconfirm = getPopconfirmAttrs(popconfirm, btnObj as BtnItem);\r\n  }\r\n  const { icon } = attrs || {};\r\n  if (icon && typeOf(icon) === \"String\") {\r\n    const currIcon = Icons[icon as keyof typeof Icons];\r\n    attrs ? (attrs.icon = currIcon) : (btnObj.attrs = { icon: currIcon });\r\n  }\r\n  return btnObj;\r\n}\r\n","import { WarningFilled } from \"@element-plus/icons-vue\";\r\nimport cssVars from \"@/assets/styles/_var.module.scss\";\r\nimport { CommonObj } from \"@/vite-env\";\r\nimport config from \"@/config\";\r\nimport { getExportData } from \"@/components/_utils\";\r\n\r\nexport * from \"./_utils\";\r\nexport * from \"./_types\";\r\n\r\nconst customBtsMap = config?.BaseBtn?.btnsMap;\r\nconst { colorDanger, colorInfo, colorSuccess, colorWarning } = cssVars;\r\n\r\nconst btnsMap: CommonObj = {\r\n  add: {\r\n    name: \"add\",\r\n    text: \"新增\",\r\n    // auth: [0,1,2],\r\n    // to: undefined,\r\n    order: 0,\r\n    attrs: {\r\n      type: \"success\",\r\n      icon: \"CirclePlus\",\r\n    },\r\n  },\r\n  edit: {\r\n    name: \"edit\",\r\n    text: \"编辑\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 1,\r\n    attrs: {\r\n      type: \"success\",\r\n      icon: \"Edit\",\r\n    },\r\n  },\r\n  delete: {\r\n    name: \"delete\",\r\n    text: \"删除\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 2,\r\n    attrs: {\r\n      type: \"danger\",\r\n      icon: \"Delete\",\r\n    },\r\n    popconfirm: {\r\n      icon: WarningFilled,\r\n      iconColor: colorDanger,\r\n      confirmButtonType: \"danger\",\r\n    },\r\n  },\r\n  pass: {\r\n    name: \"pass\",\r\n    text: \"通过\",\r\n    // auth: [0,1,2],\r\n    // to: undefined,\r\n    order: 3,\r\n    validate: true,\r\n    attrs: {\r\n      type: \"success\",\r\n      icon: \"Checked\",\r\n    },\r\n    popconfirm: {\r\n      icon: \"CircleCheck\",\r\n      iconColor: colorSuccess,\r\n      confirmButtonType: \"success\",\r\n    },\r\n  },\r\n  reject: {\r\n    name: \"reject\",\r\n    text: \"驳回\",\r\n    // auth: [0,1,2],\r\n    // to: undefined,\r\n    order: 4,\r\n    validate: true,\r\n    attrs: {\r\n      type: \"danger\",\r\n      icon: \"Failed\",\r\n    },\r\n    popconfirm: {\r\n      icon: \"CircleClose\",\r\n      iconColor: colorDanger,\r\n      confirmButtonType: \"danger\",\r\n    },\r\n  },\r\n  repeal: {\r\n    name: \"repeal\",\r\n    text: \"撤销\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 5,\r\n    attrs: {\r\n      type: \"warning\",\r\n      icon: \"TopLeft\",\r\n    },\r\n  },\r\n  import: {\r\n    name: \"import\",\r\n    text: \"导入\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 6,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"Top\",\r\n    },\r\n  },\r\n  export: {\r\n    name: \"export\",\r\n    text: \"导出\",\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 7,\r\n    customRules: false,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"Bottom\",\r\n    },\r\n    popconfirm: true,\r\n  },\r\n  upload: {\r\n    name: \"upload\",\r\n    text: \"上传\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 8,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"Upload\",\r\n    },\r\n  },\r\n  download: {\r\n    name: \"download\",\r\n    text: \"下载\",\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 9,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"Download\",\r\n    },\r\n  },\r\n  enable: {\r\n    name: \"enable\",\r\n    text: \"启用\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 10,\r\n    attrs: {\r\n      type: \"success\",\r\n      icon: \"CircleCheck\",\r\n    },\r\n    popconfirm: {\r\n      iconColor: colorSuccess,\r\n      confirmButtonType: \"success\",\r\n    },\r\n  },\r\n  forbid: {\r\n    name: \"forbid\",\r\n    text: \"禁用\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 11,\r\n    attrs: {\r\n      type: \"warning\",\r\n      icon: \"Remove\",\r\n    },\r\n    popconfirm: {\r\n      iconColor: colorWarning,\r\n      confirmButtonType: \"warning\",\r\n    },\r\n  },\r\n  audit: {\r\n    name: \"audit\",\r\n    text: \"审核\",\r\n    // auth: [0, 1, 2],\r\n    // to: undefined,\r\n    order: 20,\r\n    attrs: {\r\n      type: \"success\",\r\n      icon: \"Edit\",\r\n    },\r\n  },\r\n  view: {\r\n    name: \"view\",\r\n    text: \"详情\", //查看\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 21,\r\n    attrs: {\r\n      type: \"info\",\r\n      icon: \"View\",\r\n    },\r\n  },\r\n  submit: {\r\n    name: \"submit\",\r\n    text: \"提交\",\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 40,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"DocumentChecked\",\r\n    },\r\n  },\r\n  reset: {\r\n    name: \"reset\",\r\n    text: \"重置\",\r\n    // auth: [0],\r\n    // to: undefined,\r\n    order: 41,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"RefreshLeft\",\r\n    },\r\n  },\r\n  log: {\r\n    name: \"log\",\r\n    text: \"日志\",\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 42,\r\n    attrs: {\r\n      type: \"primary\",\r\n      icon: \"Tickets\",\r\n    },\r\n  },\r\n  //当按钮的name不对时，默认展示这个空按钮，用于给开发者提示\r\n  empty: {\r\n    name: \"empty\",\r\n    text: \"~empty~\",\r\n    // auth: [],\r\n    // to: undefined,\r\n    order: 100,\r\n    attrs: {\r\n      type: \"danger\",\r\n    },\r\n  },\r\n};\r\n\r\nexport default getExportData(btnsMap, customBtsMap, \"merge\");\r\n"],"names":["getBtnObj","btn","row","t","typeOf","btnObj","name","targetBtn","btnsMap","Object","assign","empty","text","icon","attrs","JSON","parse","stringify","merge","auth","popconfirm","length","map","it","disabled","code","getUserInfo","type","title","iconColor","cssVars","upperFirst","confirmButtonType","CircleCloseFilled","getPopconfirmAttrs","currIcon","Icons","customBtsMap","_b","_a","config","BaseBtn","colorDanger","colorInfo","colorSuccess","colorWarning","btnsMap$1","getExportData","add","order","edit","delete","WarningFilled","pass","validate","reject","repeal","import","export","customRules","upload","download","enable","forbid","audit","view","submit","reset","log"],"mappings":"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"}