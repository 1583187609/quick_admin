{"version":3,"file":"MenuTree-c3370e89.js","sources":["../../../src/views/system/menu/AddEdit/_components/MenuTree.vue"],"sourcesContent":["<template>\r\n  <el-popover ref=\"popoverRef\" placement=\"bottom\" :width=\"width - 100\" trigger=\"click\">\r\n    <template #reference>\r\n      <el-input v-model=\"menuText\" placeholder=\"请选择父级菜单\" @clear=\"emits('update:modelValue', '')\" clearable></el-input>\r\n    </template>\r\n    <el-tree\r\n      class=\"menu-tree\"\r\n      ref=\"treeRef\"\r\n      :data=\"data\"\r\n      :props=\"{\r\n        label: 'name',\r\n        class: customNodeClass,\r\n      }\"\r\n      @node-click=\"handleNodeClick\"\r\n      :expand-on-click-node=\"false\"\r\n    />\r\n  </el-popover>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, watch, computed } from \"vue\";\r\nimport { ElTree, useFormItem, ElMessage } from \"element-plus\";\r\nimport { getTextFromTreeByKey } from \"@/utils\";\r\nimport { StrNum } from \"@/vite-env\";\r\n\r\nexport interface MenuTreeNode {\r\n  id: number;\r\n  parentId: number;\r\n  name: string;\r\n\r\n  type: 0 | 1 | 2 | 3; //0目录 1菜单 2外链 3按钮\r\n  component: string;\r\n  // haveChild: boolean;\r\n  disabled: boolean;\r\n  children: MenuTreeNode[];\r\n}\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    width?: number;\r\n    data?: MenuTreeNode[];\r\n    modelValue?: StrNum; //父级id\r\n  }>(),\r\n  {\r\n    data: () => [],\r\n    width: 600,\r\n    modelValue: \"\",\r\n  }\r\n);\r\nconst emits = defineEmits([\"update:modelValue\"]);\r\nconst treeRef = ref<InstanceType<typeof ElTree>>();\r\nconst customNodeClass = (data: MenuTreeNode, node: MenuTreeNode) => {\r\n  if (data.type === 0) return null;\r\n  return \"node-hide\";\r\n};\r\nconst menuText = computed(() => {\r\n  return getTextFromTreeByKey(props.data, props.modelValue, \"name\");\r\n});\r\nconst popoverRef = ref<any>(null);\r\nconst { formItem } = useFormItem();\r\nconst handleNodeClick = (data: MenuTreeNode) => {\r\n  const { id, name } = data;\r\n  emits(\"update:modelValue\", id);\r\n  formItem?.validate(\"blur\");\r\n  popoverRef.value.hide();\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.menu-tree {\r\n  max-height: 500px;\r\n  overflow: auto;\r\n}\r\n:deep(.node-hide) {\r\n  display: none;\r\n}\r\n</style>\r\n"],"names":["props","__props","emits","__emit","treeRef","ref","customNodeClass","data","node","type","menuText","computed","getTextFromTreeByKey","modelValue","popoverRef","formItem","useFormItem","handleNodeClick","id","name","validate","value","hide"],"mappings":"yiDAoCA,MAAMA,EAAQC,EAYRC,EAAQC,EACRC,EAAUC,IACVC,EAAkB,CAACC,EAAoBC,IACzB,IAAdD,EAAKE,KAAmB,KACrB,YAEHC,EAAWC,GAAS,IACjBC,EAAqBZ,EAAMO,KAAMP,EAAMa,WAAY,UAEtDC,EAAaT,EAAS,OACtBU,SAAEA,GAAaC,IACfC,EAAmBV,IACjB,MAAAW,GAAEA,EAAIC,KAAAA,GAASZ,EACrBL,EAAM,oBAAqBgB,GAC3B,MAAAH,GAAAA,EAAUK,SAAS,QACnBN,EAAWO,MAAMC"}