{"version":3,"file":"BaseTable-d98d4dbc.js","sources":["../../../src/components/table/BaseTable.vue"],"sourcesContent":["<template>\r\n  <el-table class=\"base-table\" :data=\"rows\" v-bind=\"newAttrs\" ref=\"tableRef\" v-if=\"newCols.length\">\r\n    <!-- :refreshList=\"refreshList\"\r\n      :groupBtnsAttrs=\"groupBtnsAttrs\"\r\n      :getGroupBtnsOfRow=\"getGroupBtnsOfRow\"\r\n      @groupBtn=\"onGroupBtn\" -->\r\n    <Column :col=\"col\" :selection=\"selection\" v-for=\"(col, cInd) in newCols\" :key=\"cInd\">\r\n      <template #custom=\"{ row, col: c, ind }\">\r\n        <slot :name=\"c.prop\" v-bind=\"{ row, col: c, $index: ind }\"></slot>\r\n      </template>\r\n    </Column>\r\n    <template #empty>\r\n      <BaseEmpty />\r\n    </template>\r\n  </el-table>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { merge } from \"lodash\";\r\nimport { ref, reactive, watchEffect } from \"vue\";\r\nimport { CommonObj } from \"@/vite-env\";\r\nimport Column from \"@/components/BaseCrud/_components/Column.vue\";\r\nimport { TableColAttrs } from \"@/components/table\";\r\nimport { needPushSpecialCol } from \"@/components/BaseCrud\";\r\nimport { getColLevel } from \"@/components/table\";\r\nimport { getSpecialColMap } from \"@/components/table\";\r\nimport { defaultTableAttrs, defaultColumnAttrs } from \"@/components/table\";\r\nimport { typeOf, handleTableSummary } from \"@/components/_utils\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"BaseTable\" }); \n\r\n\r\nconst specialColMap = getSpecialColMap();\r\nconst props = withDefaults(\r\n  defineProps<{\r\n    cols: TableColAttrs[]; //表头\r\n    rows: CommonObj[]; //表格行数据\r\n    total?: number;\r\n    pageAttrs?: CommonObj; //分页属性\r\n    sort?: boolean; //是否显示排序列\r\n    index?: boolean; //是否展示序号列\r\n    selection?: boolean; //是否显示选择框\r\n    sortable?: boolean; //是否启用排序\r\n    showSummary?: boolean; //是否显示汇总行\r\n    summaryMethod?: (arg: any) => string[]; //计算汇总的方法\r\n  }>(),\r\n  {\r\n    cols: () => [],\r\n    rows: () => [],\r\n    summaryMethod: handleTableSummary,\r\n  }\r\n);\r\nconst tableRef = ref<any>();\r\nconst newAttrs = reactive(merge({}, defaultTableAttrs));\r\nconst newCols = ref<TableColAttrs[]>([]);\r\n//调用stopWatch（），确保下面的方法只执行一次\r\nconst stopWatch = watchEffect(() => {\r\n  const { cols } = props;\r\n  needPushSpecialCol(\"index\", props) && cols.unshift(specialColMap.index);\r\n  needPushSpecialCol(\"sort\", props) && cols.unshift(specialColMap.sort);\r\n  needPushSpecialCol(\"selection\", props) && cols.unshift(specialColMap.selection);\r\n  needPushSpecialCol(\"operate\", props) && cols.push(specialColMap.operate);\r\n  const levels = cols.map(col => {\r\n    if (typeOf(col) !== \"Object\") return 1;\r\n    const { col: newCol, level } = getColLevel(col as TableColAttrs, 1, specialColMap, defaultColumnAttrs);\r\n    newCols.value.push(newCol);\r\n    return level;\r\n  });\r\n  // const maxLev = Math.max(...levels);\r\n  // rowNum += maxLev - 1;\r\n  // emits(\"update:cols\", newCols.value);\r\n});\r\nstopWatch();\r\ndefineExpose({\r\n  tableRef,\r\n});\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n// .base-table {\r\n// :deep(.base-table .el-table__row) {\r\n//   overscroll-behavior: auto;\r\n// }\r\n// }\r\n</style>\r\n"],"names":["specialColMap","getSpecialColMap","props","__props","tableRef","ref","newAttrs","reactive","merge","defaultTableAttrs","newCols","watchEffect","cols","needPushSpecialCol","unshift","index","sort","selection","push","operate","map","col","typeOf","newCol","level","getColLevel","defaultColumnAttrs","value","__expose"],"mappings":"irEA+BA,MAAMA,EAAgBC,IAChBC,EAAQC,EAmBRC,EAAWC,IACXC,EAAWC,EAASC,EAAAA,MAAM,CAAA,EAAIC,IAC9BC,EAAUL,EAAqB,WAEnBM,GAAY,KACtB,MAAAC,KAAEA,GAASV,EACjBW,EAAmB,QAASX,IAAUU,EAAKE,QAAQd,EAAce,OACjEF,EAAmB,OAAQX,IAAUU,EAAKE,QAAQd,EAAcgB,MAChEH,EAAmB,YAAaX,IAAUU,EAAKE,QAAQd,EAAciB,WACrEJ,EAAmB,UAAWX,IAAUU,EAAKM,KAAKlB,EAAcmB,SAC5CP,EAAAQ,KAAWC,IACzB,GAAgB,WAAhBC,EAAOD,GAA0B,OAAA,EAC/B,MAAEA,IAAKE,EAAQC,MAAAA,GAAUC,EAAYJ,EAAsB,EAAGrB,EAAe0B,GAE5E,OADChB,EAAAiB,MAAMT,KAAKK,GACZC,CAAA,GACR,MAMUI,EAAA,CACXxB"}