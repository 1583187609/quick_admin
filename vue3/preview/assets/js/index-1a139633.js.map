{"version":3,"file":"index-1a139633.js","sources":["../../../src/views/system/user/account/index.vue"],"sourcesContent":["<template>\r\n  <BaseCrud\r\n    :cols=\"cols\"\r\n    :fields=\"fields\"\r\n    :fetch=\"GetUserList\"\r\n    :extraBtns=\"['add', { name: 'add', text: '新增（url)', to: '/system/user/detail' }, , 'delete', 'import', 'export']\"\r\n    :groupBtns=\"[\r\n      'edit',\r\n      {\r\n        name: 'edit',\r\n        text: '编辑（url)',\r\n        to: (row: CommonObj) => `/system/user/detail?id=${row.id}`,\r\n      },\r\n      'delete',\r\n      (row: CommonObj) => (row?.status === 1 ? 'forbid' : 'enable'),\r\n      'view',\r\n    ]\"\r\n    @extraBtn=\"onExtraBtn\"\r\n    @groupBtn=\"onGroupBtn\"\r\n    @dargSortEnd=\"handleDragSortEnd\"\r\n    selection\r\n    index\r\n    sort\r\n  >\r\n  </BaseCrud>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { DeleteUserList, GetUserList, PostUserListExport, PostUserUpdate } from \"@/api-mock\";\r\nimport { FormField } from \"@/components/BaseFormItem\";\r\nimport { TableField } from \"@/components/table\";\r\nimport { ref, reactive, inject, h } from \"vue\";\r\nimport { BaseBtnType, BtnName } from \"@/components/BaseBtn\";\r\nimport AddEdit from \"./AddEdit.vue\";\r\nimport { exportExcel, handleBtnNext } from \"@/utils\";\r\nimport { CommonObj, FinallyNext } from \"@/vite-env\";\r\nimport { ExtraBtnRestArgs } from \"@/components/BaseCrud\";\nimport { defineOptions } from 'vue'; \ndefineOptions({ name: \"SystemUserAccount\" }); \n\r\n\r\nconst openPopup: any = inject(\"openPopup\");\r\nconst fields = ref<FormField[]>([\r\n  { prop: \"id\", label: \"用户ID\" },\r\n  { prop: \"name\", label: \"用户姓名\" },\r\n  {\r\n    prop: \"age\",\r\n    label: \"年龄\",\r\n    type: \"BaseNumberRange\",\r\n    // attrs: { minProp: \"min_age\", maxProp: \"max_age\" },\r\n  },\r\n  {\r\n    prop: \"gender\",\r\n    label: \"性别\",\r\n    type: \"select\",\r\n    options: \"Gender\",\r\n  },\r\n  {\r\n    prop: \"type\",\r\n    label: \"用户类型\",\r\n    type: \"select\",\r\n    options: \"RoleType\",\r\n  },\r\n  {\r\n    prop: \"status\",\r\n    label: \"账号状态\",\r\n    type: \"select\",\r\n    options: \"EnableStatus\",\r\n  },\r\n]);\r\nconst cols: TableField[] = [\r\n  { prop: \"id\", label: \"用户ID\", width: 70 },\r\n  { prop: \"name\", label: \"用户姓名\", width: 90 },\r\n  { prop: \"gender_text\", label: \"性别\", width: 90 },\r\n  { prop: \"age\", label: \"年龄\", width: 90, sortable: true },\r\n  { prop: \"address_text\", label: \"地址\", minWidth: 250 },\r\n  { prop: \"phone\", label: \"电话\", minWidth: 120 },\r\n  { prop: \"type_text\", label: \"用户类型\", minWidth: 100 },\r\n  { prop: \"status\", label: \"状态\", type: \"BaseTag\" },\r\n];\r\n//点击操作栏的分组按钮\r\nfunction onGroupBtn(name: BtnName, row: CommonObj, next: FinallyNext) {\r\n  handleBtnNext(\r\n    {\r\n      edit: () => handleAddEdit(row, next),\r\n      view: () => handleView(row),\r\n      delete: () => handleDelete([row.id], next),\r\n      forbid: () => handleToggleStatus(row, next),\r\n      enable: () => handleToggleStatus(row, next),\r\n    },\r\n    name\r\n  );\r\n}\r\n//点击列表上方的额外的按钮\r\nfunction onExtraBtn(name: BtnName, next: FinallyNext, restArgs: ExtraBtnRestArgs) {\r\n  const { selectedKeys } = restArgs;\r\n  handleBtnNext(\r\n    {\r\n      add: () => handleAddEdit(null, next),\r\n      delete: () => handleDelete(selectedKeys, next),\r\n      export: () => handleExport(selectedKeys, next),\r\n    },\r\n    name\r\n  );\r\n}\r\n//新增/编辑\r\nfunction handleAddEdit(row: CommonObj | null, next: FinallyNext) {\r\n  openPopup(row ? \"编辑\" : \"新增\", h(AddEdit, { id: row?.id, refreshList: next }));\r\n}\r\n//查看\r\nfunction handleView(row: CommonObj) {\r\n  openPopup(\"查看\", h(AddEdit, { id: row.id, pureText: true }));\r\n}\r\n//批量删除\r\nfunction handleDelete(ids: string[], next: FinallyNext) {\r\n  DeleteUserList({ ids }).then((res: any) => {\r\n    next();\r\n  });\r\n}\r\n//导出\r\nfunction handleExport(ids: string[], next: FinallyNext) {\r\n  PostUserListExport({ ids, cols }).then((res: any) => {\r\n    exportExcel(res, \"用户列表\");\r\n    next();\r\n  });\r\n}\r\n//禁用\r\nfunction handleToggleStatus(row: CommonObj, next: FinallyNext) {\r\n  const { status, id } = row;\r\n  PostUserUpdate({\r\n    id,\r\n    status: status === 1 ? 2 : 1,\r\n  }).then((res: CommonObj) => {\r\n    next();\r\n  });\r\n}\r\n//处理列表排序\r\nfunction handleDragSortEnd(data: CommonObj, next: any) {\r\n  console.log(data, \"data-----------------\");\r\n  next();\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped></style>\r\n"],"names":["openPopup","inject","fields","ref","prop","label","type","options","cols","width","sortable","minWidth","onGroupBtn","name","row","next","handleBtnNext","edit","handleAddEdit","view","h","AddEdit","id","pureText","handleView","delete","handleDelete","forbid","handleToggleStatus","enable","onExtraBtn","restArgs","selectedKeys","add","export","ids","PostUserListExport","then","res","exportExcel","handleExport","refreshList","DeleteUserList","status","PostUserUpdate","handleDragSortEnd","data"],"mappings":"ioDAwCM,MAAAA,EAAiBC,EAAO,aACxBC,EAASC,EAAiB,CAC9B,CAAEC,KAAM,KAAMC,MAAO,QACrB,CAAED,KAAM,OAAQC,MAAO,QACvB,CACED,KAAM,MACNC,MAAO,KACPC,KAAM,mBAGR,CACEF,KAAM,SACNC,MAAO,KACPC,KAAM,SACNC,QAAS,UAEX,CACEH,KAAM,OACNC,MAAO,OACPC,KAAM,SACNC,QAAS,YAEX,CACEH,KAAM,SACNC,MAAO,OACPC,KAAM,SACNC,QAAS,kBAGPC,EAAqB,CACzB,CAAEJ,KAAM,KAAMC,MAAO,OAAQI,MAAO,IACpC,CAAEL,KAAM,OAAQC,MAAO,OAAQI,MAAO,IACtC,CAAEL,KAAM,cAAeC,MAAO,KAAMI,MAAO,IAC3C,CAAEL,KAAM,MAAOC,MAAO,KAAMI,MAAO,GAAIC,UAAU,GACjD,CAAEN,KAAM,eAAgBC,MAAO,KAAMM,SAAU,KAC/C,CAAEP,KAAM,QAASC,MAAO,KAAMM,SAAU,KACxC,CAAEP,KAAM,YAAaC,MAAO,OAAQM,SAAU,KAC9C,CAAEP,KAAM,SAAUC,MAAO,KAAMC,KAAM,YAG9B,SAAAM,EAAWC,EAAeC,EAAgBC,GACjDC,EACE,CACEC,KAAM,IAAMC,EAAcJ,EAAKC,GAC/BI,KAAM,IAyBZ,SAAoBL,GACRd,EAAA,KAAMoB,EAAEC,EAAS,CAAEC,GAAIR,EAAIQ,GAAIC,UAAU,IACrD,CA3BkBC,CAAWV,GACvBW,OAAQ,IAAMC,EAAa,CAACZ,EAAIQ,IAAKP,GACrCY,OAAQ,IAAMC,EAAmBd,EAAKC,GACtCc,OAAQ,IAAMD,EAAmBd,EAAKC,IAExCF,EAEJ,CAES,SAAAiB,EAAWjB,EAAeE,EAAmBgB,GAC9C,MAAAC,aAAEA,GAAiBD,EACzBf,EACE,CACEiB,IAAK,IAAMf,EAAc,KAAMH,GAC/BU,OAAQ,IAAMC,EAAaM,EAAcjB,GACzCmB,OAAQ,IAoBL,SAAaC,EAAepB,GACnCqB,EAAmB,CAAED,MAAK3B,SAAQ6B,MAAMC,IACtCC,EAAYD,EAAK,cAGrB,CAzBoBE,CAAaR,EAAcjB,IAE3CF,EAEJ,CAES,SAAAK,EAAcJ,EAAuBC,GAC5Cf,EAAUc,EAAM,KAAO,KAAMM,EAAEC,EAAS,CAAEC,GAAI,MAAAR,OAAA,EAAAA,EAAKQ,GAAImB,YAAa1B,IACtE,CAMS,SAAAW,EAAaS,EAAepB,GACnC2B,EAAe,CAAEP,QAAOE,MAAMC,UAGhC,CASS,SAAAV,EAAmBd,EAAgBC,GACpC,MAAA4B,OAAEA,EAAQrB,GAAAA,GAAOR,EACR8B,EAAA,CACbtB,KACAqB,OAAmB,IAAXA,EAAe,EAAI,IAC1BN,MAAMC,UAGX,CAES,SAAAO,EAAkBC,EAAiB/B,MAG5C"}