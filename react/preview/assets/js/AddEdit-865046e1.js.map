{"version":3,"file":"AddEdit-865046e1.js","sources":["../../../src/views/test/test-3/AddEdit.tsx"],"sourcesContent":["import { FormField, StandardFormFieldAttrs } from \"@/components/BaseFormItem\";\r\nimport BaseForm from \"@/components/form/BaseForm\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { GetUserInfo, PostMockCommon } from \"@/api-mock\";\r\nimport UploadAvatar from \"@/components/upload/UploadAvatar\";\r\nimport { CommonObj } from \"@/vite-env\";\r\n\r\ninterface Props {\r\n  id?: string;\r\n  disabled?: boolean;\r\n  refreshList?: () => void;\r\n}\r\nfunction getFields({ isAdd = false, formRef }: CommonObj): FormField[] {\r\n  return [\r\n    {\r\n      name: \"avatar\",\r\n      label: \"头像\",\r\n      type: \"Custom\",\r\n      render: (attrs: StandardFormFieldAttrs) => <UploadAvatar name=\"avatar\" {...attrs} formRef={formRef} />,\r\n    },\r\n    !isAdd && {\r\n      name: \"nickname\",\r\n      label: \"用户昵称\",\r\n      attrs: {\r\n        disabled: true,\r\n      },\r\n    },\r\n    {\r\n      name: \"phone\",\r\n      label: \"电话\",\r\n      required: true,\r\n      otherAttrs: {\r\n        valid: \"phone\",\r\n      },\r\n    },\r\n    {\r\n      name: \"name\",\r\n      label: \"姓名\",\r\n      required: true,\r\n      otherAttrs: {\r\n        valid: \"userName\",\r\n      },\r\n    },\r\n    {\r\n      name: \"type\",\r\n      label: \"用户类型\",\r\n      type: \"Select\",\r\n      attrs: {\r\n        options: \"RoleType\",\r\n      },\r\n    },\r\n    {\r\n      name: \"gender\",\r\n      label: \"性别\",\r\n      type: \"RadioGroup\",\r\n      attrs: {\r\n        options: \"Gender\",\r\n      },\r\n    },\r\n    {\r\n      name: \"age\",\r\n      label: \"年龄\",\r\n      type: \"InputNumber\",\r\n      attrs: {\r\n        max: 100,\r\n        min: 0,\r\n        maxLength: 3,\r\n      },\r\n      otherAttrs: {\r\n        valid: \"age\",\r\n      },\r\n    },\r\n    {\r\n      name: \"address\",\r\n      label: \"地址\",\r\n      type: \"Cascader\",\r\n      attrs: {\r\n        options: \"Region\",\r\n      },\r\n    },\r\n  ];\r\n}\r\n\r\nexport default ({ id, disabled, refreshList }: Props) => {\r\n  const formRef = useRef();\r\n  const [initVals, setInitVals] = useState<CommonObj | null>(id ? null : { gender: 0 });\r\n  useEffect(() => {\r\n    id && getDetail(id);\r\n  }, [id]);\r\n  //获取详情数据\r\n  function getDetail(id: string) {\r\n    GetUserInfo({ id }).then((res: CommonObj) => {\r\n      setInitVals(res);\r\n    });\r\n  }\r\n  return (\r\n    (id ? !!initVals : true) && (\r\n      <BaseForm\r\n        ref={formRef}\r\n        initialValues={initVals}\r\n        style={{ width: \"450px\" }}\r\n        fields={getFields({\r\n          isAdd: !id,\r\n          formRef,\r\n        })}\r\n        disabled={disabled}\r\n        fetch={PostMockCommon}\r\n        fetchSuccess={refreshList}\r\n      />\r\n    )\r\n  );\r\n};\r\n"],"names":["getFields","isAdd","formRef","attrs","jsx","UploadAvatar","AddEdit","id","disabled","refreshList","useRef","initVals","setInitVals","useState","useEffect","getDetail","GetUserInfo","res","BaseForm","PostMockCommon"],"mappings":"wlFAYA,SAASA,EAAU,CAAE,MAAAC,EAAQ,GAAO,QAAAC,GAAmC,CAC9D,MAAA,CACL,CACE,KAAM,SACN,MAAO,KACP,KAAM,SACN,OAASC,GAAkCC,EAAAA,IAACC,GAAa,KAAK,SAAU,GAAGF,EAAO,QAAAD,EAAkB,CACtG,EACA,CAACD,GAAS,CACR,KAAM,WACN,MAAO,OACP,MAAO,CACL,SAAU,EACZ,CACF,EACA,CACE,KAAM,QACN,MAAO,KACP,SAAU,GACV,WAAY,CACV,MAAO,OACT,CACF,EACA,CACE,KAAM,OACN,MAAO,KACP,SAAU,GACV,WAAY,CACV,MAAO,UACT,CACF,EACA,CACE,KAAM,OACN,MAAO,OACP,KAAM,SACN,MAAO,CACL,QAAS,UACX,CACF,EACA,CACE,KAAM,SACN,MAAO,KACP,KAAM,aACN,MAAO,CACL,QAAS,QACX,CACF,EACA,CACE,KAAM,MACN,MAAO,KACP,KAAM,cACN,MAAO,CACL,IAAK,IACL,IAAK,EACL,UAAW,CACb,EACA,WAAY,CACV,MAAO,KACT,CACF,EACA,CACE,KAAM,UACN,MAAO,KACP,KAAM,WACN,MAAO,CACL,QAAS,QACX,CACF,CAAA,CAEJ,CAEA,MAAeK,GAAA,CAAC,CAAE,GAAAC,EAAI,SAAAC,EAAU,YAAAC,KAAyB,CACvD,MAAMP,EAAUQ,EAAAA,SACV,CAACC,EAAUC,CAAW,EAAIC,EAAA,SAA2BN,EAAK,KAAO,CAAE,OAAQ,CAAA,CAAG,EACpFO,EAAAA,UAAU,IAAM,CACdP,GAAMQ,EAAUR,CAAE,CAAA,EACjB,CAACA,CAAE,CAAC,EAEP,SAASQ,EAAUR,EAAY,CAC7BS,EAAY,CAAE,GAAAT,CAAI,CAAA,EAAE,KAAMU,GAAmB,CAC3CL,EAAYK,CAAG,CAAA,CAChB,CACH,CACA,OACGV,EAAK,CAAC,CAACI,EAAW,KACjBP,EAAA,IAACc,EAAA,CACC,IAAKhB,EACL,cAAeS,EACf,MAAO,CAAE,MAAO,OAAQ,EACxB,OAAQX,EAAU,CAChB,MAAO,CAACO,EACR,QAAAL,CAAA,CACD,EACD,SAAAM,EACA,MAAOW,EACP,aAAcV,CAAA,CAAA,CAItB"}