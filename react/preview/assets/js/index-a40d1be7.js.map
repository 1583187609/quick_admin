{"version":3,"file":"index-a40d1be7.js","sources":["../../../src/views/system/menu/index.tsx"],"sourcesContent":["/**\r\n * 文件说明-模板文件\r\n */\r\n\r\nimport { GetAuthMenuList, PostMockCommon } from \"@/api-mock\";\r\nimport { PopupContext } from \"@/components/provider/PopupProvider\";\r\nimport { BtnName } from \"@/components/BaseBtn\";\r\nimport BaseCrud from \"@/components/BaseCrud\";\r\nimport { FormField } from \"@/components/BaseFormItem\";\r\nimport BaseIcon, { IconNames } from \"@/components/BaseIcon\";\r\nimport { TableCol } from \"@/components/table/_types\";\r\nimport { useContext } from \"react\";\r\nimport AddEdit from \"./AddEdit\";\r\nimport { CommonObj, FinallyNext } from \"@/vite-env\";\r\nimport { handleBtnNext, showMessage } from \"@/utils\";\r\n\r\nexport const fields: FormField[] = [\r\n  {\r\n    name: \"name\",\r\n    label: \"菜单名称\",\r\n  },\r\n  {\r\n    name: \"status\",\r\n    label: \"状态\",\r\n    type: \"Select\",\r\n    attrs: {\r\n      options: \"EnableStatus\",\r\n    },\r\n  },\r\n  {\r\n    name: \"is_cache\",\r\n    label: \"是否缓存\",\r\n    type: \"Select\",\r\n    attrs: {\r\n      options: \"YesNoStatus\",\r\n    },\r\n  },\r\n  {\r\n    name: \"is_frame\",\r\n    label: \"是否外链\",\r\n    type: \"Select\",\r\n    attrs: {\r\n      options: \"YesNoStatus\",\r\n    },\r\n  },\r\n  { name: \"create_time\", label: \"创建时间\", type: \"DateRangePicker\" },\r\n];\r\nexport const columns: TableCol[] = [\r\n  { dataIndex: \"name\", title: \"菜单名称\", width: 150 },\r\n  { dataIndex: \"type_text\", title: \"菜单类型\", width: 80 },\r\n  {\r\n    dataIndex: \"icon\",\r\n    title: \"菜单图标\",\r\n    width: 80,\r\n    render(text: string) {\r\n      return <BaseIcon size=\"20\" name={text as IconNames} />;\r\n    },\r\n  },\r\n  { dataIndex: \"order\", title: \"排序\", width: 80 },\r\n  { dataIndex: \"perms\", title: \"权限标识\", width: 180 },\r\n  { dataIndex: \"menu_path\", title: \"菜单路径\", width: 250 },\r\n  { dataIndex: \"component_path\", title: \"组件路径\", width: 300 },\r\n  { dataIndex: \"status_text\", title: \"是否启用\", width: 80 },\r\n  { dataIndex: \"remark\", title: \"备注\", width: 250 },\r\n  { dataIndex: \"create_time\", title: \"创建时间\", width: 120 },\r\n  { dataIndex: \"update_time\", title: \"更新时间\", width: 120 },\r\n];\r\nexport default () => {\r\n  const { openPopup } = useContext(PopupContext);\r\n  // useEffect(() => {\r\n  //   openPopup(\"新增\", <AddEdit />);\r\n  // }, []);\r\n  function handleExtraBtn(name: BtnName, info: CommonObj, next: FinallyNext) {\r\n    const { ids } = info;\r\n    const map: CommonObj = {\r\n      add: () => openPopup(\"新增\", <AddEdit />),\r\n      delete: () => handleDelete(ids, next),\r\n    };\r\n    map[name]?.();\r\n  }\r\n  function handleOperateBtn(name: BtnName, row: CommonObj, next: FinallyNext) {\r\n    const { id } = row;\r\n    handleBtnNext(\r\n      {\r\n        edit: () => openPopup(\"编辑\", <AddEdit />),\r\n        delete: () => handleDelete([id], next),\r\n        forbid: () => handleForbid([id], next),\r\n      },\r\n      name\r\n    );\r\n  }\r\n  function handleDelete(ids: string[], next: FinallyNext) {\r\n    PostMockCommon({ ids }).then((res: CommonObj) => next());\r\n  }\r\n  function handleForbid(ids: string[], next: FinallyNext) {\r\n    PostMockCommon({ ids }).then((res: CommonObj) => next());\r\n  }\r\n  return (\r\n    <BaseCrud\r\n      fields={fields}\r\n      columns={columns}\r\n      fetch={GetAuthMenuList}\r\n      extraBtns={[\"add\", \"delete\"]}\r\n      operateBtns={[\"edit\", \"delete\", (row: CommonObj) => (true ? \"forbid\" : \"enable\")]}\r\n      onExtraBtn={handleExtraBtn}\r\n      onOperateBtn={handleOperateBtn}\r\n      selection\r\n    />\r\n  );\r\n};\r\n"],"names":["fields","columns","text","jsx","BaseIcon","index","openPopup","useContext","PopupContext","handleExtraBtn","name","info","next","ids","map","AddEdit","handleDelete","_a","handleOperateBtn","row","id","handleBtnNext","handleForbid","PostMockCommon","res","BaseCrud","GetAuthMenuList"],"mappings":"62FAgBO,MAAMA,EAAsB,CACjC,CACE,KAAM,OACN,MAAO,MACT,EACA,CACE,KAAM,SACN,MAAO,KACP,KAAM,SACN,MAAO,CACL,QAAS,cACX,CACF,EACA,CACE,KAAM,WACN,MAAO,OACP,KAAM,SACN,MAAO,CACL,QAAS,aACX,CACF,EACA,CACE,KAAM,WACN,MAAO,OACP,KAAM,SACN,MAAO,CACL,QAAS,aACX,CACF,EACA,CAAE,KAAM,cAAe,MAAO,OAAQ,KAAM,iBAAkB,CAChE,EACaC,EAAsB,CACjC,CAAE,UAAW,OAAQ,MAAO,OAAQ,MAAO,GAAI,EAC/C,CAAE,UAAW,YAAa,MAAO,OAAQ,MAAO,EAAG,EACnD,CACE,UAAW,OACX,MAAO,OACP,MAAO,GACP,OAAOC,EAAc,CACnB,OAAQC,EAAAA,IAAAC,EAAA,CAAS,KAAK,KAAK,KAAMF,CAAmB,CAAA,CACtD,CACF,EACA,CAAE,UAAW,QAAS,MAAO,KAAM,MAAO,EAAG,EAC7C,CAAE,UAAW,QAAS,MAAO,OAAQ,MAAO,GAAI,EAChD,CAAE,UAAW,YAAa,MAAO,OAAQ,MAAO,GAAI,EACpD,CAAE,UAAW,iBAAkB,MAAO,OAAQ,MAAO,GAAI,EACzD,CAAE,UAAW,cAAe,MAAO,OAAQ,MAAO,EAAG,EACrD,CAAE,UAAW,SAAU,MAAO,KAAM,MAAO,GAAI,EAC/C,CAAE,UAAW,cAAe,MAAO,OAAQ,MAAO,GAAI,EACtD,CAAE,UAAW,cAAe,MAAO,OAAQ,MAAO,GAAI,CACxD,EACAG,GAAe,IAAM,CACnB,KAAM,CAAE,UAAAC,CAAA,EAAcC,EAAA,WAAWC,CAAY,EAIpC,SAAAC,EAAeC,EAAeC,EAAiBC,EAAmB,OACnE,KAAA,CAAE,IAAAC,CAAQ,EAAAF,EACVG,EAAiB,CACrB,IAAK,IAAMR,EAAU,KAAMH,EAAAA,IAACY,IAAQ,CAAE,EACtC,OAAQ,IAAMC,EAAaH,EAAKD,CAAI,CAAA,GAEtCK,EAAAH,EAAIJ,KAAJ,MAAAO,EAAA,KAAAH,EACF,CACS,SAAAI,EAAiBR,EAAeS,EAAgBP,EAAmB,CACpE,KAAA,CAAE,GAAAQ,CAAO,EAAAD,EACfE,EACE,CACE,KAAM,IAAMf,EAAU,KAAMH,EAAAA,IAACY,IAAQ,CAAE,EACvC,OAAQ,IAAMC,EAAa,CAACI,CAAE,EAAGR,CAAI,EACrC,OAAQ,IAAMU,EAAa,CAACF,CAAE,EAAGR,CAAI,CACvC,EACAF,CAAA,CAEJ,CACS,SAAAM,EAAaH,EAAeD,EAAmB,CACvCW,EAAA,CAAE,IAAAV,EAAK,EAAE,KAAMW,GAAmBZ,GAAM,CACzD,CACS,SAAAU,EAAaT,EAAeD,EAAmB,CACvCW,EAAA,CAAE,IAAAV,EAAK,EAAE,KAAMW,GAAmBZ,GAAM,CACzD,CAEE,OAAAT,EAAA,IAACsB,EAAA,CACC,OAAAzB,EACA,QAAAC,EACA,MAAOyB,EACP,UAAW,CAAC,MAAO,QAAQ,EAC3B,YAAa,CAAC,OAAQ,SAAWP,GAA2B,QAAoB,EAChF,WAAYV,EACZ,aAAcS,EACd,UAAS,EAAA,CAAA,CAGf"}